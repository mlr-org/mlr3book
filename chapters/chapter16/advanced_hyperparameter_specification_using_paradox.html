<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>16&nbsp; Advanced Hyperparameter Specification using paradox – Applied Machine Learning Using mlr3 in R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/references.html" rel="next">
<link href="../../chapters/chapter15/predsets_valid_inttune.html" rel="prev">
<link href="../../Figures/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0d45b1ff1595a53868627e64e30aef28.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-54b1fec74e0844836633235e285d9714.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/chapter10/advanced_technical_aspects_of_mlr3.html">Advanced Topics</a></li><li class="breadcrumb-item"><a href="../../chapters/chapter16/advanced_hyperparameter_specification_using_paradox.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced Hyperparameter Specification using paradox</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Applied Machine Learning Using mlr3 in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/mlr-org/mlr3book/tree/main/book/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../../Applied-Machine-Learning-Using-mlr3-in-R.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter1/introduction_and_overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction and Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Fundamentals</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter2/data_and_basic_modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data and Basic Modeling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter3/evaluation_and_benchmarking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Evaluation and Benchmarking</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Tuning and Feature Selection</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter4/hyperparameter_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hyperparameter Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter5/advanced_tuning_methods_and_black_box_optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Advanced Tuning Methods and Black Box Optimization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter6/feature_selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Feature Selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Pipelines and Preprocessing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter7/sequential_pipelines.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Sequential Pipelines</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter8/non-sequential_pipelines_and_tuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Non-sequential Pipelines and Tuning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter9/preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Preprocessing</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter10/advanced_technical_aspects_of_mlr3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Advanced Technical Aspects of mlr3</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter11/large-scale_benchmarking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Large-Scale Benchmarking</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter12/model_interpretation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Model Interpretation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter13/beyond_regression_and_classification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Beyond Regression and Classification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter14/algorithmic_fairness.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Algorithmic Fairness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter15/predsets_valid_inttune.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Predict Sets, Validation and Internal Tuning (+)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/chapter16/advanced_hyperparameter_specification_using_paradox.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced Hyperparameter Specification using paradox</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendices/solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Solutions to exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendices/tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Tasks</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendices/overview-tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Overview Tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendices/errata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Errata</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/appendices/session_info.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Session Info</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#reference-based-objects" id="toc-reference-based-objects" class="nav-link active" data-scroll-target="#reference-based-objects"><span class="header-section-number">16.1</span> Reference Based Objects</a></li>
  <li>
<a href="#defining-a-parameter-space" id="toc-defining-a-parameter-space" class="nav-link" data-scroll-target="#defining-a-parameter-space"><span class="header-section-number">16.2</span> Defining a Parameter Space</a>
  <ul class="collapse">
<li><a href="#domain-representing-single-parameters" id="toc-domain-representing-single-parameters" class="nav-link" data-scroll-target="#domain-representing-single-parameters"><span class="header-section-number">16.2.1</span> <code>Domain</code> Representing Single Parameters</a></li>
  <li><a href="#parameter-sets" id="toc-parameter-sets" class="nav-link" data-scroll-target="#parameter-sets"><span class="header-section-number">16.2.2</span> Parameter Sets</a></li>
  <li><a href="#vector-parameters" id="toc-vector-parameters" class="nav-link" data-scroll-target="#vector-parameters"><span class="header-section-number">16.2.3</span> Vector Parameters</a></li>
  </ul>
</li>
  <li>
<a href="#parameter-sampling" id="toc-parameter-sampling" class="nav-link" data-scroll-target="#parameter-sampling"><span class="header-section-number">16.3</span> Parameter Sampling</a>
  <ul class="collapse">
<li><a href="#parameter-designs" id="toc-parameter-designs" class="nav-link" data-scroll-target="#parameter-designs"><span class="header-section-number">16.3.1</span> Parameter Designs</a></li>
  <li><a href="#grid-design" id="toc-grid-design" class="nav-link" data-scroll-target="#grid-design"><span class="header-section-number">16.3.2</span> Grid Design</a></li>
  <li><a href="#random-sampling" id="toc-random-sampling" class="nav-link" data-scroll-target="#random-sampling"><span class="header-section-number">16.3.3</span> Random Sampling</a></li>
  <li><a href="#generalized-sampling-the-sampler-class" id="toc-generalized-sampling-the-sampler-class" class="nav-link" data-scroll-target="#generalized-sampling-the-sampler-class"><span class="header-section-number">16.3.4</span> Generalized Sampling: The <code>Sampler</code> Class</a></li>
  </ul>
</li>
  <li>
<a href="#parameter-transformation" id="toc-parameter-transformation" class="nav-link" data-scroll-target="#parameter-transformation"><span class="header-section-number">16.4</span> Parameter Transformation</a>
  <ul class="collapse">
<li><a href="#transformation-between-types" id="toc-transformation-between-types" class="nav-link" data-scroll-target="#transformation-between-types"><span class="header-section-number">16.4.1</span> Transformation between Types</a></li>
  <li><a href="#automatic-factor-level-transformation" id="toc-automatic-factor-level-transformation" class="nav-link" data-scroll-target="#automatic-factor-level-transformation"><span class="header-section-number">16.4.2</span> Automatic Factor Level Transformation</a></li>
  </ul>
</li>
  <li>
<a href="#sec-paradox-tuning-spaces" id="toc-sec-paradox-tuning-spaces" class="nav-link" data-scroll-target="#sec-paradox-tuning-spaces"><span class="header-section-number">16.5</span> Defining a Tuning Space</a>
  <ul class="collapse">
<li><a href="#sec-paradox-creation-tuning-paramset-from-learner" id="toc-sec-paradox-creation-tuning-paramset-from-learner" class="nav-link" data-scroll-target="#sec-paradox-creation-tuning-paramset-from-learner"><span class="header-section-number">16.5.1</span> Creating Tuning ParamSets from other ParamSets</a></li>
  </ul>
</li>
  <li><a href="#citation" id="toc-citation" class="nav-link" data-scroll-target="#citation"><span class="header-section-number">16.6</span> Citation</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/mlr-org/mlr3book/edit/main/book/chapters/chapter16/advanced_hyperparameter_specification_using_paradox.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mlr-org/mlr3book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/mlr-org/mlr3book/blob/main/book/chapters/chapter16/advanced_hyperparameter_specification_using_paradox.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/chapter10/advanced_technical_aspects_of_mlr3.html">Advanced Topics</a></li><li class="breadcrumb-item"><a href="../../chapters/chapter16/advanced_hyperparameter_specification_using_paradox.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced Hyperparameter Specification using paradox</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-paradox" class="quarto-section-identifier"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Advanced Hyperparameter Specification using paradox</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>Martin Binder</strong> <br><em>Ludwig-Maximilians-Universität München, and Munich Center for Machine Learning (MCML)</em></p>
<p><strong>Sebastian Fischer</strong> <br><em>Ludwig-Maximilians-Universität München, and Munich Center for Machine Learning (MCML)</em></p>
<p><strong>Michel Lang</strong> <br><em>Research Center Trustworthy Data Science and Security, and TU Dortmund University</em></p>
<p><strong>Alexander Winterstetter</strong> <br><em>Ludwig-Maximilians-Universität München</em> <br><br></p>
<p>In previous chapters, we have already outlined how hyperparameters can be set manually (<a href="../chapter2/data_and_basic_modeling.html#sec-param-set" class="quarto-xref"><span>Section 2.2.3</span></a>) or optimized automatically (<a href="../chapter4/hyperparameter_optimization.html" class="quarto-xref"><span>Chapter 4</span></a>).</p>
<p>In this chapter, we will introduce the <a href="https://paradox.mlr-org.com"><code>paradox</code></a> package, which offers a language for the description of parameter spaces, as well as tools for useful operations on these parameter spaces. A parameter space is often useful when describing:</p>
<ul>
<li>A set of sensible input values for an R function</li>
<li>The set of possible values that fields of a configuration object can take</li>
<li>The search space of an optimization process</li>
</ul>
<p>The tools provided by <code>paradox</code> therefore relate to:</p>
<ul>
<li>Parameter checking: Verifying that a set of parameters satisfies the conditions of a parameter space</li>
<li>Parameter sampling: Generating parameter values that lie in the parameter space for systematic exploration of program behavior depending on these parameters</li>
</ul>
<p><code>paradox</code> is, by nature, an auxiliary package that derives its usefulness from other packages that make use of it. It is heavily utilized in other packages of the <code>mlr3</code> ecosystem such as <a href="https://mlr3.mlr-org.com"><code>mlr3</code></a>, <a href="https://mlr3pipelines.mlr-org.com"><code>mlr3pipelines</code></a>, <a href="https://mlr3tuning.mlr-org.com"><code>mlr3tuning</code></a>, and <a href="https://cran.r-project.org/package=miesmuschel"><code>miesmuschel</code></a>.</p>
<section id="reference-based-objects" class="level2" data-number="16.1"><h2 data-number="16.1" class="anchored" data-anchor-id="reference-based-objects">
<span class="header-section-number">16.1</span> Reference Based Objects</h2>
<p>It is important to know that some objects created in <a href="https://paradox.mlr-org.com"><code>paradox</code></a> are “reference-based”, unlike most other objects in R. When a change is made to a <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a> object, for example by changing the <code>$values</code> field, all variables that point to this parameter set will contain the changed object. To create an independent copy of a parameter set, the <code>$clone(deep = TRUE)</code> method needs to be used:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://paradox.mlr-org.com">"paradox"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps1</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span>init <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ps2</span> <span class="op">=</span> <span class="va">ps1</span></span>
<span><span class="va">ps3</span> <span class="op">=</span> <span class="va">ps1</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
   id    class lower upper nlevels        default value
1:  a ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt;     1</code></pre>
</div>
</div>
<p>At this point, <code>ps1</code>, <code>ps2</code>, and <code>ps3</code> all contain the same values. Now we change the value of <code>a</code> in <code>ps1</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">a</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
   id    class lower upper nlevels        default value
1:  a ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt;     2</code></pre>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
   id    class lower upper nlevels        default value
1:  a ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt;     2</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
   id    class lower upper nlevels        default value
1:  a ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt;     1</code></pre>
</div>
</div>
<p>Because <code>ps2</code> holds the same reference as <code>ps1</code>, the change is reflected in <code>ps2</code> as well. However, <code>ps3</code> is an independent clone of the original <code>ps1</code> and still has <code>a</code> set to <code>1</code>.</p>
</section><section id="defining-a-parameter-space" class="level2" data-number="16.2"><h2 data-number="16.2" class="anchored" data-anchor-id="defining-a-parameter-space">
<span class="header-section-number">16.2</span> Defining a Parameter Space</h2>
<section id="domain-representing-single-parameters" class="level3" data-number="16.2.1"><h3 data-number="16.2.1" class="anchored" data-anchor-id="domain-representing-single-parameters">
<span class="header-section-number">16.2.1</span> <code>Domain</code> Representing Single Parameters</h3>
<p>Parameter spaces are made up of individual parameters, which usually can take a single atomic value. Consider, for example, trying to configure the <a href="https://cran.r-project.org/package=rpart"><code>rpart</code></a> package’s <code><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart::rpart.control()</a></code> object. It has various components (<code>minsplit</code>, <code>cp</code>, …) that all take a single value.</p>
<p>These components are represented by <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>Domain</code></a> objects, which can be created using the sugar functions in <a href="#tbl-paradox-define" class="quarto-xref">Table&nbsp;<span>16.1</span></a>.</p>
<div id="tbl-paradox-define" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-paradox-define-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16.1: <code>Domain</code> Constructors and their resulting <code>Domain</code>.
</figcaption><div aria-describedby="tbl-paradox-define-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead><tr class="header">
<th>Constructor</th>
<th>Description</th>
<th>Underlying Class</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_dbl</code></a></td>
<td>Real valued parameter (“double”)</td>
<td><code>ParamDbl</code></td>
</tr>
<tr class="even">
<td><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_int</code></a></td>
<td>Integer parameter</td>
<td><code>ParamInt</code></td>
</tr>
<tr class="odd">
<td><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_fct</code></a></td>
<td>Discrete valued parameter (“factor”)</td>
<td><code>ParamFct</code></td>
</tr>
<tr class="even">
<td><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_lgl</code></a></td>
<td>Logical / Boolean parameter</td>
<td><code>ParamLgl</code></td>
</tr>
<tr class="odd">
<td><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_uty</code></a></td>
<td>Untyped parameter</td>
<td><code>ParamUty</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>A <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a> that represents a given set of parameters is created by calling <a href="https://paradox.mlr-org.com/reference/ps.html"><code>ps()</code></a> with named arguments that are <code>Domain</code> objects. While domain objects themselves are R objects that can in principle be handled and manipulated, they should not be changed after construction.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://paradox.mlr-org.com">"paradox"</a></span><span class="op">)</span></span>
<span><span class="va">param_set</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  parA <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_lgl</a></span><span class="op">(</span>init <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  parB <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">10</span>, tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tag1"</span>, <span class="st">"tag2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  parC <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">4</span>, special_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  parD <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, default <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>,</span>
<span>  parE <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_uty</a></span><span class="op">(</span>custom_check <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFunction.html">checkFunction</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">param_set</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(5)&gt;
     id    class lower upper nlevels        default  value
1: parA ParamLgl    NA    NA       2 &lt;NoDefault[0]&gt;  FALSE
2: parB ParamInt     0    10      11 &lt;NoDefault[0]&gt; [NULL]
3: parC ParamDbl     0     4     Inf &lt;NoDefault[0]&gt; [NULL]
4: parD ParamFct    NA    NA       3              y [NULL]
5: parE ParamUty    NA    NA     Inf &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
</div>
<p>Every parameter can have:</p>
<ul>
<li>
<strong>default</strong> - A default value, indicating the behavior of something if the specific value is not given.</li>
<li>
<strong>init</strong> - An initial value, which is set in <code>$values</code> when the <code>ParamSet</code> is created. Note, that this is not the same as <code>default</code>: <code>default</code> is used when a parameter is not present in <code>$values</code>, while <code>init</code> is the value that is set upon creation.</li>
<li>
<strong>special_vals</strong> - A list of values that are accepted even if they do not conform to the type.</li>
<li>
<strong>tags</strong> - Tags that can be used to organize parameters.</li>
<li>
<strong>trafo</strong> - A transformation function that is applied to the parameter value after it has been sampled. It is for example used through the <code>Design$transpose()</code> function after a <a href="https://paradox.mlr-org.com/reference/Design.html"><code>Design</code></a> was created by <a href="https://paradox.mlr-org.com/reference/generate_design_random.html"><code>generate_design_random()</code></a> or similar functions.</li>
</ul>
<p>The numeric (<code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int()</a></code> and <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl()</a></code>) parameters furthermore allow for specification of a <strong>lower</strong> and <strong>upper</strong> bound. Meanwhile, the <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct()</a></code> parameter must be given a vector of <strong>levels</strong> that define the possible states its parameter can take. The <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_uty()</a></code> parameter can also have a <strong><code>custom_check</code></strong> function that must return <code>TRUE</code> when a value is acceptable and may return a <code>character(1)</code> error description otherwise. The example above defines <code>parE</code> as a parameter that only accepts functions.</p>
<p>All values which are given to the constructor are then accessible from the <code>ParamSet</code> for inspection using <code>$</code>. The parameter set should be considered immutable, except for some fields such as <code>$values</code>, <code>$deps</code>, <code>$tags</code>. Bounds and levels should not be changed after construction. Instead, a new <code>ParamSet</code> should be constructed.</p>
<p>Besides the possible values that can be given to a constructor, there are also the <code>$class</code>, <code>$nlevels</code>, <code>$is_bounded</code>, <code>$has_default</code>, <code>$storage_type</code>, <code>$is_number</code> and <code>$is_categ</code> fields that give information about a parameter.</p>
<p>A list of all fields can be found in <code><a href="https://paradox.mlr-org.com/reference/ParamSet.html">?ParamSet</a></code>.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="va">lower</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parA parB parC parD parE 
  NA    0    0   NA   NA </code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="va">levels</span><span class="op">$</span><span class="va">parD</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "x" "y" "z"</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="va">class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      parA       parB       parC       parD       parE 
"ParamLgl" "ParamInt" "ParamDbl" "ParamFct" "ParamUty" </code></pre>
</div>
</div>
<section id="type-range-checking" class="level4" data-number="16.2.1.1"><h4 data-number="16.2.1.1" class="anchored" data-anchor-id="type-range-checking">
<span class="header-section-number">16.2.1.1</span> Type / Range Checking</h4>
<p>The <code>ParamSet</code> object offers the possibility to check whether a value satisfies its condition, i.e.&nbsp;is of the right type, and also falls within the range of allowed values, using the <code>$test()</code>, <code>$check()</code>, and <code>$assert()</code> functions. Their argument must be a named list with values that are checked against the respective parameters, and it is possible to check only a subset of parameters. <code>$test()</code> should be used within conditional checks and returns <code>TRUE</code> or <code>FALSE</code>, while <code>$check()</code> returns an error description when a value does not conform to the parameter (and thus plays well with the <a href="https://www.rdocumentation.org/packages/checkmate/topics/assert"><code>assert()</code></a>-function). <code>$assert()</code> will throw an error whenever a value does not fit.</p>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="fu">test</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>parA <span class="op">=</span> <span class="cn">FALSE</span>, parB <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="fu">test</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>parA <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">param_set</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>parA <span class="op">=</span> <span class="st">"FALSE"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "parA: Must be of type 'logical flag', not 'character'"</code></pre>
</div>
</div>
</section></section><section id="parameter-sets" class="level3" data-number="16.2.2"><h3 data-number="16.2.2" class="anchored" data-anchor-id="parameter-sets">
<span class="header-section-number">16.2.2</span> Parameter Sets</h3>
<p>The ordered collection of parameters is handled in a <code>ParamSet</code>. It is typically created by calling <code><a href="https://paradox.mlr-org.com/reference/ps.html">ps()</a></code>, but can also be initialized using the <code>ParamSet$new()</code> function. The main difference is that <code><a href="https://paradox.mlr-org.com/reference/ps.html">ps()</a></code> takes named arguments, whereas <code>ParamSet$new()</code> takes a named list. The latter makes it easier to construct a parameter set programmatically, but is slightly more verbose.</p>
<p><code>ParamSet</code>s can be combined using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> or <a href="https://paradox.mlr-org.com/reference/ps_union.html"><code>ps_union()</code></a> (the latter of which takes a list), and they have a <code>$subset()</code> method that allows for subsetting. All of these functions return a new, cloned parameter set-object, and do not modify the original parameter set.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps1</span> <span class="op">=</span> <span class="va"><a href="https://paradox.mlr-org.com/reference/ParamSet.html">ParamSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ps2</span> <span class="op">=</span> <span class="va"><a href="https://paradox.mlr-org.com/reference/ParamSet.html">ParamSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>z <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ps_all</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ps1</span>, <span class="va">ps2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps_all</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(3)&gt;
   id    class lower upper nlevels        default  value
1:  x ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt; [NULL]
2:  y ParamDbl  -Inf   Inf     Inf &lt;NoDefault[0]&gt; [NULL]
3:  z ParamFct    NA    NA       3 &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps_all</span><span class="op">$</span><span class="fu">subset</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(2)&gt;
   id    class lower upper nlevels        default  value
1:  x ParamInt  -Inf   Inf     Inf &lt;NoDefault[0]&gt; [NULL]
2:  z ParamFct    NA    NA       3 &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
</div>
<p><code>ParamSet</code>s of each individual parameters can be accessed through the <code>$subspaces()</code> function by returning a named list of single-parameter <code>ParamSets</code>s.</p>
<p>It is possible to get the <code>ParamSet</code> as a <a href="https://www.rdocumentation.org/packages/data.table/topics/data.table-package"><code>data.table</code></a> using <code><a href="https://rdrr.io/pkg/data.table/man/as.data.table.html">as.data.table()</a></code>. This makes it easy to subset parameters on certain conditions and aggregate information about them, using the variety of methods provided by <a href="https://cran.r-project.org/package=data.table"><code>data.table</code></a>.</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">ps_all</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id    class lower upper levels nlevels is_bounded special_vals
1:  x ParamInt  -Inf   Inf [NULL]     Inf      FALSE    &lt;list[0]&gt;
2:  y ParamDbl  -Inf   Inf [NULL]     Inf      FALSE    &lt;list[0]&gt;
3:  z ParamFct    NA    NA  a,b,c       3       TRUE    &lt;list[0]&gt;
3 variables not shown: [default, storage_type, tags]</code></pre>
</div>
</div>
<section id="values-in-a-paramset" class="level4" data-number="16.2.2.1"><h4 data-number="16.2.2.1" class="anchored" data-anchor-id="values-in-a-paramset">
<span class="header-section-number">16.2.2.1</span> Values in a <code>ParamSet</code>
</h4>
<p>Although a <code>ParamSet</code> fundamentally represents a value space, it also has a field <code>$values</code> that can contain a point within that space. This is useful because many things that define a parameter space need similar operations (like parameter checking) that can be simplified. The <code>$values</code> field contains a named list that is always checked against parameter constraints. When trying to set parameter values, e.g.&nbsp;for <a href="https://mlr3.mlr-org.com"><code>mlr3</code></a> <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a>s, it is the <code>$values</code> field of its <code>$param_set</code> that needs to be used.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">y</span> <span class="op">=</span> <span class="fl">2.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 1

$y
[1] 2.5</code></pre>
</div>
</div>
<p>The parameter constraints are automatically checked:</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">x</span> <span class="op">=</span> <span class="fl">1.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `self$assert()`:
! Assertion on 'xs' failed: x: Must be of type 'single integerish value', not 'double'.</code></pre>
</div>
</div>
<p>To set multiple values at once we recommend using <code>$set_values()</code>, which updates the given hyperparameters (argument names) with the respective values.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps1</span><span class="op">$</span><span class="fu">set_values</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, y <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps1</span><span class="op">$</span><span class="va">values</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 2

$y
[1] 3</code></pre>
</div>
</div>
</section><section id="dependencies" class="level4" data-number="16.2.2.2"><h4 data-number="16.2.2.2" class="anchored" data-anchor-id="dependencies">
<span class="header-section-number">16.2.2.2</span> Dependencies</h4>
<p>It is often the case that certain parameters are irrelevant or should not be given depending on values of other parameters. An example would be a parameter that switches a certain algorithm feature (for example regularization) on or off, combined with another parameter that controls the behavior of that feature (e.g.&nbsp;a regularization parameter). The second parameter would be said to <em>depend</em> on the first parameter having the value <code>TRUE</code>.</p>
<p>A dependency can be added using the <code>$add_dep</code> method, which takes both the ids of the “depender” and “dependee” parameters as well as a <a href="https://paradox.mlr-org.com/reference/condition_test.html"><code>Condition</code></a> object. The <code>Condition</code> object represents the check to be performed on the “dependee”. Currently it can be created using <a href="https://paradox.mlr-org.com/reference/condition_test.html"><code>CondEqual()</code></a> and <a href="https://paradox.mlr-org.com/reference/condition_test.html"><code>CondAnyOf()</code></a>. Multiple dependencies can be added, and parameters that depend on others can again be depended on, as long as no cyclic dependencies are introduced.</p>
<p>The consequences of dependencies are twofold: For one, the <code>$check()</code>, <code>$test()</code>, and <code>$assert()</code> functions will reject any value supplied for a parameter if its dependency is not satisfied, when the <code>check_strict</code> argument is given as <code>TRUE</code>. This differs from simply omitting the parameter, which is always allowed. Furthermore, when sampling or creating grid designs from a <code>ParamSet</code>, the dependencies will be respected.</p>
<p>The easiest way to set dependencies is to give the <code>depends</code> argument to the <code>Domain</code> constructor.</p>
<p>The following example makes parameter <code>D</code> depend on parameter <code>A</code> being <code>FALSE</code>, and parameter <code>B</code> depend on parameter <code>D</code> being one of <code>"x"</code> or <code>"y"</code>. This introduces an implicit dependency of <code>B</code> on <code>A</code> being <code>FALSE</code> as well, because <code>D</code> does not take any value if <code>A</code> is <code>TRUE</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_lgl</a></span><span class="op">(</span>init <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">10</span>, depends <span class="op">=</span> <span class="va">D</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  C <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  D <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span>, depends <span class="op">=</span> <span class="va">A</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the <code>depends</code> argument is limited to operators <code>==</code> and <code>%in%</code>, so <code>D = p_fct(..., depends = !A)</code> would not work.</p>
<p>All dependencies are met, so the check passes:</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">FALSE</span>, D <span class="op">=</span> <span class="st">"x"</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p><code>B</code>’s dependency on <code>D %in% c("x", "y")</code> is not met because <code>D</code> is <code>"z"</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">FALSE</span>, D <span class="op">=</span> <span class="st">"z"</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B: can only be set if the following condition is met 'D %in% {x, y}'. Instead the current parameter value is: D == z"</code></pre>
</div>
</div>
<p><code>B</code>’s dependency is not met because <code>D</code> is absent:</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">FALSE</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B: can only be set if the following condition is met 'D %in% {x, y}'. Instead the parameter value for 'D' is not set at all. Try setting 'D' to a value that satisfies the condition"</code></pre>
</div>
</div>
<p><code>B</code> is absent, so its dependency does not apply:</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">FALSE</span>, D <span class="op">=</span> <span class="st">"z"</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Neither <code>B</code> nor <code>D</code> are present, so no dependencies are violated:</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p><code>D</code>’s dependency on <code>A == FALSE</code> is not met:</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">TRUE</span>, D <span class="op">=</span> <span class="st">"x"</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "D: can only be set if the following condition is met 'A == FALSE'. Instead the current parameter value is: A == TRUE"</code></pre>
</div>
</div>
<p><code>B</code>’s dependency is not met because <code>D</code> is not present (and cannot be, since <code>A</code> is <code>TRUE</code>):</p>
<div class="cell">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="cn">TRUE</span>, B <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, check_strict <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "B: can only be set if the following condition is met 'D %in% {x, y}'. Instead the parameter value for 'D' is not set at all. Try setting 'D' to a value that satisfies the condition"</code></pre>
</div>
</div>
<p>Internally, the dependencies are represented as a <code>data.table</code>, which can be accessed listed in the <code>$deps</code> field. This <code>data.table</code> can even be mutated, to e.g.&nbsp;remove dependencies. There are no sanity checks done when the <code>$deps</code> field is changed this way. Therefore it is advised to be cautious.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span><span class="op">$</span><span class="va">deps</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id on                  cond
1:  B  D &lt;Condition:CondAnyOf&gt;
2:  D  A &lt;Condition:CondEqual&gt;</code></pre>
</div>
</div>
</section></section><section id="vector-parameters" class="level3" data-number="16.2.3"><h3 data-number="16.2.3" class="anchored" data-anchor-id="vector-parameters">
<span class="header-section-number">16.2.3</span> Vector Parameters</h3>
<p>There are no vectorial parameters in <a href="https://paradox.mlr-org.com"><code>paradox</code></a>. Instead, it is now possible to create multiple copies of a single parameter using the <a href="https://paradox.mlr-org.com/reference/ps_replicate.html"><code>ps_replicate()</code></a> function. This creates a <code>ParamSet</code> consisting of multiple copies of the parameter, which can then (optionally) be added to another <code>ParamSet</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps2d</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps_replicate.html">ps_replicate</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">0</span>, upper <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ps2d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(2)&gt;
       id    class lower upper nlevels        default  value
1: rep1.x ParamDbl     0     1     Inf &lt;NoDefault[0]&gt; [NULL]
2: rep2.x ParamDbl     0     1     Inf &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
</div>
<p>It is also possible to use a <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_uty()</a></code> to accept vectorial parameters, which also works for parameters of variable length. A <code>ParamSet</code> containing a <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_uty()</a></code> can be used for parameter checking, but not for sampling. To sample values for a method that needs a vectorial parameter, it is advised to use an <code>$.extra_trafo</code> transformation function that creates a vector from atomic values.</p>
<p>Assembling a vector from repeated parameters is aided by the parameter’s <code>$tags</code>: Parameters that were generated by the <code><a href="https://paradox.mlr-org.com/reference/ps_replicate.html">ps_replicate()</a></code> command can be tagged as belonging to a group of repeated parameters.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps2d</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps_replicate.html">ps_replicate</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span>, tag_params <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ps2d</span><span class="op">$</span><span class="va">values</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>rep1.x <span class="op">=</span> <span class="fl">0.2</span>, rep2.x <span class="op">=</span> <span class="fl">0.4</span>, rep1.y <span class="op">=</span> <span class="fl">3</span>, rep2.y <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">ps2d</span><span class="op">$</span><span class="va">tags</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$rep1.x
[1] "param_x"

$rep1.y
[1] "param_y"

$rep2.x
[1] "param_x"

$rep2.y
[1] "param_y"</code></pre>
</div>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps2d</span><span class="op">$</span><span class="fu">get_values</span><span class="op">(</span>tags <span class="op">=</span> <span class="st">"param_x"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$rep1.x
[1] 0.2

$rep2.x
[1] 0.4</code></pre>
</div>
</div>
</section></section><section id="parameter-sampling" class="level2" data-number="16.3"><h2 data-number="16.3" class="anchored" data-anchor-id="parameter-sampling">
<span class="header-section-number">16.3</span> Parameter Sampling</h2>
<p>It is often useful to have a list of possible parameter values that can be systematically iterated through, for example to find parameter values for which an algorithm performs particularly well (tuning). <a href="https://paradox.mlr-org.com"><code>paradox</code></a> offers a variety of functions that allow creating evenly-spaced parameter values in a “grid” design as well as random sampling. In the latter case, it is possible to influence the sampling distribution in more or less fine detail.</p>
<p>A point to always keep in mind while sampling is that only numerical and factorial parameters that are bounded can be sampled from, i.e.&nbsp;not <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_uty()</code></a>. Furthermore, for most samplers <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_int()</code></a> and <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_dbl()</code></a> must have finite lower and upper bounds.</p>
<section id="parameter-designs" class="level3" data-number="16.3.1"><h3 data-number="16.3.1" class="anchored" data-anchor-id="parameter-designs">
<span class="header-section-number">16.3.1</span> Parameter Designs</h3>
<p>Functions that sample the parameter space fundamentally return an object of the <a href="https://paradox.mlr-org.com/reference/Design.html"><code>Design</code></a> class. These objects contain the sampled data as a <code>data.table</code> under the <code>$data</code> field, and also offer conversion to a list of parameter-values using the <code>$transpose()</code> function.</p>
</section><section id="grid-design" class="level3" data-number="16.3.2"><h3 data-number="16.3.2" class="anchored" data-anchor-id="grid-design">
<span class="header-section-number">16.3.2</span> Grid Design</h3>
<p>The <a href="https://paradox.mlr-org.com/reference/generate_design_grid.html"><code>generate_design_grid()</code></a> function is used to create grid designs that contain all combinations of parameter values: All possible values for <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_lgl()</code></a> and <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_fct()</code></a>, and values with a given resolution for <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int()</a></code> and <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl()</a></code>. The resolution can be given for all numeric parameters, or for specific named parameters through the <code>param_resolutions</code> parameter.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ps_small</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">ps_small</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 4 rows:
   A B
1: 0 0
2: 0 1
3: 1 0
4: 1 1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">ps_small</span>, param_resolutions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">3</span>, B <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 6 rows:
     A B
1: 0.0 0
2: 0.0 1
3: 0.5 0
4: 0.5 1
5: 1.0 0
6: 1.0 1</code></pre>
</div>
</div>
</section><section id="random-sampling" class="level3" data-number="16.3.3"><h3 data-number="16.3.3" class="anchored" data-anchor-id="random-sampling">
<span class="header-section-number">16.3.3</span> Random Sampling</h3>
<p><code>paradox</code> offers different methods for random sampling, which vary in the degree to which they can be configured (see <a href="#fig-paradox-sampling" class="quarto-xref">Figure&nbsp;<span>16.1</span></a>). The easiest way to get a uniformly random sample of parameters is <a href="https://paradox.mlr-org.com/reference/generate_design_random.html"><code>generate_design_random()</code></a>. It is also possible to create latin hypercube sampled parameter values using <a href="https://paradox.mlr-org.com/reference/generate_design_lhs.html"><code>generate_design_lhs()</code></a>, which utilizes the <a href="https://cran.r-project.org/package=lhs"><code>lhs</code></a> package. LHS-sampling creates low-discrepancy sampled values that cover the parameter space more evenly than purely random values. <a href="https://paradox.mlr-org.com/reference/generate_design_sobol.html"><code>generate_design_sobol()</code></a> can be used to sample using the Sobol sequence.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">pvrand</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random</a></span><span class="op">(</span><span class="va">ps_small</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">pvlhs</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_lhs.html">generate_design_lhs</a></span><span class="op">(</span><span class="va">ps_small</span>, <span class="fl">500</span><span class="op">)</span></span>
<span><span class="va">pvsobol</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_sobol.html">generate_design_sobol</a></span><span class="op">(</span><span class="va">ps_small</span>, <span class="fl">500</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fig-paradox-sampling" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-paradox-sampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-paradox-sampling" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-paradox-sampling-1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing 500 randomly sampled points in a unit square with uneven clustering.">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-paradox-sampling-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="advanced_hyperparameter_specification_using_paradox_files/figure-html/fig-paradox-sampling-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-paradox-sampling" alt="Scatter plot showing 500 randomly sampled points in a unit square with uneven clustering.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-paradox-sampling-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Random design
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-paradox-sampling" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-paradox-sampling-2" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing 500 Sobol sequence sampled points in a unit square with more even coverage.">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-paradox-sampling-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="advanced_hyperparameter_specification_using_paradox_files/figure-html/fig-paradox-sampling-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-paradox-sampling" alt="Scatter plot showing 500 Sobol sequence sampled points in a unit square with more even coverage.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-paradox-sampling-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Sobol design
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-paradox-sampling" style="flex-basis: 33.3%;justify-content: flex-start;">
<div id="fig-paradox-sampling-3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Scatter plot showing 500 latin hypercube sampled points in a unit square with more even coverage.">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-paradox-sampling-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="advanced_hyperparameter_specification_using_paradox_files/figure-html/fig-paradox-sampling-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-paradox-sampling" alt="Scatter plot showing 500 latin hypercube sampled points in a unit square with more even coverage.">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-paradox-sampling-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) LHS design
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-paradox-sampling-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16.1: Comparison of random, latin hypercube, and Sobol sequence sampling designs for a two-dimensional parameter space.
</figcaption></figure>
</div>
</section><section id="generalized-sampling-the-sampler-class" class="level3" data-number="16.3.4"><h3 data-number="16.3.4" class="anchored" data-anchor-id="generalized-sampling-the-sampler-class">
<span class="header-section-number">16.3.4</span> Generalized Sampling: The <code>Sampler</code> Class</h3>
<p>It may sometimes be desirable to configure parameter sampling in more detail. <code>paradox</code> uses the <a href="https://paradox.mlr-org.com/reference/Sampler.html"><code>Sampler</code></a> abstract base class for sampling, which has many different sub-classes that can be parameterized and combined to control the sampling process. It is even possible to create further sub-classes of the <code>Sampler</code> class (or of any of <em>its</em> subclasses) for even more possibilities.</p>
<p>Every <code>Sampler</code> object has a <a href="https://www.rdocumentation.org/packages/base/topics/sample"><code>sample()</code></a> function, which takes one argument, the number of instances to sample, and returns a <code>Design</code> object.</p>
<section id="d-samplers" class="level4" data-number="16.3.4.1"><h4 data-number="16.3.4.1" class="anchored" data-anchor-id="d-samplers">
<span class="header-section-number">16.3.4.1</span> 1D-Samplers</h4>
<p>There is a variety of samplers that sample values for a single parameter. These are <a href="https://paradox.mlr-org.com/reference/Sampler1DUnif.html"><code>Sampler1DUnif</code></a> (uniform sampling), <a href="https://paradox.mlr-org.com/reference/Sampler1DCateg.html"><code>Sampler1DCateg</code></a> (sampling for categorical parameters), <a href="https://paradox.mlr-org.com/reference/Sampler1DNormal.html"><code>Sampler1DNormal</code></a> (normally distributed sampling, truncated at parameter bounds), and <a href="https://paradox.mlr-org.com/reference/Sampler1DRfun.html"><code>Sampler1DRfun</code></a> (arbitrary 1D sampling, given a random-function). These are initialized with a one-dimensional <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a>, and can then be used to sample values.</p>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sampA</span> <span class="op">=</span> <span class="va"><a href="https://paradox.mlr-org.com/reference/Sampler1DCateg.html">Sampler1DCateg</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="va">letters</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sampA</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 5 rows:
   x
1: b
2: d
3: b
4: d
5: a</code></pre>
</div>
</div>
</section><section id="hierarchical-sampler" class="level4" data-number="16.3.4.2"><h4 data-number="16.3.4.2" class="anchored" data-anchor-id="hierarchical-sampler">
<span class="header-section-number">16.3.4.2</span> Hierarchical Sampler</h4>
<p>The <a href="https://paradox.mlr-org.com/reference/SamplerHierarchical.html"><code>SamplerHierarchical</code></a> sampler is an auxiliary sampler that combines many 1D-Samplers to get a combined distribution. Its name “hierarchical” implies that it is able to respect parameter dependencies. This suggests that parameters only get sampled when their dependencies are met.</p>
<p>The following example shows how this works: The <code>Int</code> parameter <code>B</code> depends on the <code>Lgl</code> parameter <code>A</code> being <code>TRUE</code>. <code>A</code> is sampled to be <code>TRUE</code> in about half the cases, in which case <code>B</code> takes a value between 0 and 10. In the cases where <code>A</code> is <code>FALSE</code>, <code>B</code> is set to <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_lgl</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_int</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, depends <span class="op">=</span> <span class="va">A</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_subspaces</span> <span class="op">=</span> <span class="va">p</span><span class="op">$</span><span class="fu">subspaces</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sampH</span> <span class="op">=</span> <span class="va"><a href="https://paradox.mlr-org.com/reference/SamplerHierarchical.html">SamplerHierarchical</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">p</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va"><a href="https://paradox.mlr-org.com/reference/Sampler1DCateg.html">Sampler1DCateg</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">p_subspaces</span><span class="op">$</span><span class="va">A</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://paradox.mlr-org.com/reference/Sampler1DUnif.html">Sampler1DUnif</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">p_subspaces</span><span class="op">$</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sampled</span> <span class="op">=</span> <span class="va">sampH</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">sampled</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       A  B
1: FALSE NA
2:  TRUE  7
3:  TRUE  2
4:  TRUE  9
5:  TRUE  9
6: FALSE NA</code></pre>
</div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">sampled</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       B
A         0   1   2   3   4   5   6   7   8   9  10 &lt;NA&gt;
  FALSE   0   0   0   0   0   0   0   0   0   0   0  509
  TRUE   48  50  37  41  54  43  39  41  40  43  55    0</code></pre>
</div>
</div>
</section><section id="joint-sampler" class="level4" data-number="16.3.4.3"><h4 data-number="16.3.4.3" class="anchored" data-anchor-id="joint-sampler">
<span class="header-section-number">16.3.4.3</span> Joint Sampler</h4>
<p>Another way of combining samplers is the <a href="https://paradox.mlr-org.com/reference/SamplerJointIndep.html"><code>SamplerJointIndep</code></a>. <code>SamplerJointIndep</code> also makes it possible to combine <code>Sampler</code>s that are not 1D. However, <code>SamplerJointIndep</code> currently cannot handle <code>ParamSet</code>s with dependencies.</p>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sampJ</span> <span class="op">=</span> <span class="va"><a href="https://paradox.mlr-org.com/reference/SamplerJointIndep.html">SamplerJointIndep</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va"><a href="https://paradox.mlr-org.com/reference/Sampler1DUnif.html">Sampler1DUnif</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="va"><a href="https://paradox.mlr-org.com/reference/Sampler1DUnif.html">Sampler1DUnif</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sampJ</span><span class="op">$</span><span class="fu">sample</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 5 rows:
          x      y
1: 0.251923 0.9271
2: 0.004932 0.6741
3: 0.047957 0.4288
4: 0.805049 0.8489
5: 0.075433 0.9797</code></pre>
</div>
</div>
</section><section id="samplerunif" class="level4" data-number="16.3.4.4"><h4 data-number="16.3.4.4" class="anchored" data-anchor-id="samplerunif">
<span class="header-section-number">16.3.4.4</span> SamplerUnif</h4>
<p>The <code>Sampler</code> used in <code><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random()</a></code> is the <a href="https://paradox.mlr-org.com/reference/SamplerUnif.html"><code>SamplerUnif</code></a> sampler, which corresponds to a <code>HierarchicalSampler</code> of <code>Sampler1DUnif</code> for all parameters with dependency-aware behavior identical to <code><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random()</a></code>.</p>
</section></section></section><section id="parameter-transformation" class="level2" data-number="16.4"><h2 data-number="16.4" class="anchored" data-anchor-id="parameter-transformation">
<span class="header-section-number">16.4</span> Parameter Transformation</h2>
<p>While the different <a href="https://paradox.mlr-org.com/reference/Sampler.html"><code>Sampler</code></a>s allow for a wide specification of parameter distributions, there are cases where the simplest way of getting a desired distribution is to sample parameters from a simple distribution (such as the uniform distribution) and then transform them. This can be done by constructing a <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>Domain</code></a> with a <code>trafo</code> argument, or assigning a function to the <code>$.extra_trafo</code> field of a <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a>. The latter can also be done by passing an <code>.extra_trafo</code> argument to the <a href="https://paradox.mlr-org.com/reference/ps.html"><code>ps()</code></a> shorthand constructor.</p>
<p>A <code>trafo</code> function in a <code>Domain</code> is called with a single parameter, the value to be transformed. It can only operate on the dimension of a single parameter.</p>
<p>The <code>$.extra_trafo</code> function is called with two parameters:</p>
<ul>
<li>The list of parameter values to be transformed as <code>x</code>. Unlike the <code>Domain</code>’s <code>trafo</code>, the <code>$.extra_trafo</code> handles the whole parameter set and can even model “interactions” between parameters.</li>
<li>The <code>ParamSet</code> itself as <code>param_set</code>
</li>
</ul>
<p>The <code>$.extra_trafo</code> function must return a list of transformed parameter values.</p>
<p>The transformation is performed when calling the <code>$transpose()</code> function of the <a href="https://paradox.mlr-org.com/reference/Design.html"><code>Design</code></a> object returned by a <code>Sampler</code> with the <code>trafo</code> parameter set to <code>TRUE</code> (the default). The following, for example, creates a parameter that is exponentially distributed:</p>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psexp</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random</a></span><span class="op">(</span><span class="va">psexp</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 3 rows:
      par
1: 0.1438
2: 0.5293
3: 0.3663</code></pre>
</div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">design</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$par
[1] 1.939


[[2]]
[[2]]$par
[1] 0.6362


[[3]]
[[3]]$par
[1] 1.004</code></pre>
</div>
</div>
<p>Printing the <code>Design</code> shows the untransformed values between 0 and 1, while <code>$transpose()</code> applies the transformation by default (<code>trafo = TRUE</code>). Compare this to <code>$transpose()</code> without transformation:</p>
<div class="cell">
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">design</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span>trafo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$par
[1] 0.1438


[[2]]
[[2]]$par
[1] 0.5293


[[3]]
[[3]]$par
[1] 0.3663</code></pre>
</div>
</div>
<p>Another way to get this effect, using <code>$.extra_trafo</code> during construction, would be:</p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">psexp</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  par <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  .extra_trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param_set</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="va">par</span> <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span>    <span class="va">x</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is also possible to set <code>$.extra_trafo</code> after construction of the <code>ParamSet</code>-object.</p>
<p>However, when transforming parameters independently the <code>trafo</code> way is more recommended. <code>.extra_trafo</code> is more useful when transforming parameters that interact in some way, or when new parameters should be generated.</p>
<section id="transformation-between-types" class="level3" data-number="16.4.1"><h3 data-number="16.4.1" class="anchored" data-anchor-id="transformation-between-types">
<span class="header-section-number">16.4.1</span> Transformation between Types</h3>
<p>Usually the design created with one <code>ParamSet</code> is then used to configure other objects that themselves have a parameter set which defines the values they take. The parameter sets which can be used for random sampling, however, are restricted in some ways: They must have finite bounds, and they may not contain “untyped” (<a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_uty</code></a>) parameters. <code>$trafo</code> provides the glue for these situations. There is relatively little constraint on the trafo function’s return value, so it is possible to return values that have different bounds or even types than the original <code>ParamSet</code>. It is even possible to remove some parameters and add new ones.</p>
<p>Suppose, for example, that a certain method requires a <em>function</em> as a parameter. Let’s say a function that summarizes its data in a certain way. The user can pass functions like <a href="https://www.rdocumentation.org/packages/stats/topics/median"><code>median()</code></a> or <a href="https://www.rdocumentation.org/packages/base/topics/mean"><code>mean()</code></a>, but could also pass quantiles or something completely different. This method would probably use the following <code>ParamSet</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">methodPS</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_uty</a></span><span class="op">(</span>custom_check <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkFunction.html">checkFunction</a></span><span class="op">(</span><span class="va">x</span>, nargs <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">methodPS</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
    id    class lower upper nlevels        default  value
1: fun ParamUty    NA    NA     Inf &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
</div>
<p>If one wanted to sample this method, using one of four functions, a way to do this would be:</p>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samplingPS</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"min"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>    trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">x</span>, mode <span class="op">=</span> <span class="st">"function"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random</a></span><span class="op">(</span><span class="va">samplingPS</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 2 rows:
    fun
1: mean
2: mean</code></pre>
</div>
</div>
<p>Note that the <code>Design</code> only contains the column “<code>fun</code>” as a <code>character</code> column. To get a single value as a <em>function</em>, the <code>$transpose()</code> function is used.</p>
<div class="cell">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xvals</span> <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$fun
function (x, ...) 
UseMethod("mean")
&lt;bytecode: 0x5579ff3b0218&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
<p>We can now check that it fits the requirements set by <code>methodPS</code>, and that <code>$fun</code> is in fact a function:</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">methodPS</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
</div>
<p><a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_fct()</code></a> has a shortcut for this kind of transformation, where a <code>character</code> is transformed into a specific set of (typically non-scalar) values. When its <code>levels</code> argument is given as a named <code>list</code> (or named non-<code>character</code> vector), it constructs a <code>Domain</code> that does the trafo automatically. A way to perform the above would therefore be:</p>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samplingPS</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"mean"</span> <span class="op">=</span> <span class="va">mean</span>, <span class="st">"median"</span> <span class="op">=</span> <span class="va">median</span>, <span class="st">"min"</span> <span class="op">=</span> <span class="va">min</span>, <span class="st">"max"</span> <span class="op">=</span> <span class="va">max</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random</a></span><span class="op">(</span><span class="va">samplingPS</span>, <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$fun
function (x, na.rm = FALSE, ...) 
UseMethod("median")
&lt;bytecode: 0x5579fe6f6ea0&gt;
&lt;environment: namespace:stats&gt;</code></pre>
</div>
</div>
<p>Imagine now that a different kind of parametrization of the function is desired: The user wants to give a function that selects a certain quantile, where the quantile is set by a parameter. In that case the <code>$transpose()</code> function could generate a function in a different way.</p>
<p>For interpretability, the parameter should be called “<code>quantile</code>” before transformation, and the “<code>fun</code>” parameter is generated on the fly. We therefore use an <code>.extra_trafo</code> here, given as a function to the <code><a href="https://paradox.mlr-org.com/reference/ps.html">ps()</a></code> call. The <code>.extra_trafo</code> receives the sampled <code>quantile</code> value (a <code>numeric(1)</code> between 0 and 1) and turns it into a function that computes the corresponding quantile of its input.</p>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samplingPS2</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>quantile <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  .extra_trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param_set</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">input</span>, <span class="va">x</span><span class="op">$</span><span class="va">quantile</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">design</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_random.html">generate_design_random</a></span><span class="op">(</span><span class="va">samplingPS2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Design&gt; with 2 rows:
   quantile
1:   0.9492
2:   0.4423</code></pre>
</div>
</div>
<p>The <code>Design</code> now contains the column “<code>quantile</code>” that will be used by the <code>$transpose()</code> function to create the <code>fun</code> parameter. We also check that it fits the requirement set by <code>methodPS</code>, and that it is a function.</p>
<div class="cell">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xvals</span> <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$fun
function (input) 
quantile(input, x$quantile)
&lt;environment: 0x557a17dac0b8&gt;</code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">methodPS</span><span class="op">$</span><span class="fu">check</span><span class="op">(</span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">xvals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="fu">fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>94.92011% 
    9.543 </code></pre>
</div>
</div>
</section><section id="automatic-factor-level-transformation" class="level3" data-number="16.4.2"><h3 data-number="16.4.2" class="anchored" data-anchor-id="automatic-factor-level-transformation">
<span class="header-section-number">16.4.2</span> Automatic Factor Level Transformation</h3>
<p>A common use-case is the necessity to specify a list of values that should all be tried (or sampled from). It may be the case that a hyperparameter accepts function objects as values and a certain list of functions should be tried. Or it may be that a choice of special numeric values should be tried. For this, the <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct()</a></code> constructor’s <code>level</code> argument may be a value that is not a <code>character</code> vector, but something else.</p>
<p>Suppose we define a search space with <code><a href="https://paradox.mlr-org.com/reference/ps.html">ps()</a></code> as described in <a href="../chapter4/hyperparameter_optimization.html#sec-tune-ps" class="quarto-xref"><span>Section 4.4.2</span></a>. If, for example, only the values <code>0.1</code>, <code>3</code>, and <code>10</code> should be tried for the <code>cost</code> parameter, even when doing random search, we can construct the search space as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">search_space</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"polynomial"</span>, <span class="st">"radial"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">search_space</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost     kernel
1:  0.1 polynomial
2:  0.1     radial
3:  3.0 polynomial
4:  3.0     radial
5: 10.0 polynomial
6: 10.0     radial</code></pre>
</div>
</div>
<p>This is equivalent to the following:</p>
<div class="cell">
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">search_space</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"0.1"</span>, <span class="st">"3"</span>, <span class="st">"10"</span><span class="op">)</span>,</span>
<span>    trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>`0.1` <span class="op">=</span> <span class="fl">0.1</span>, `3` <span class="op">=</span> <span class="fl">3</span>, `10` <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"polynomial"</span>, <span class="st">"radial"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">search_space</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost     kernel
1:  0.1 polynomial
2:  0.1     radial
3:  3.0 polynomial
4:  3.0     radial
5: 10.0 polynomial
6: 10.0     radial</code></pre>
</div>
</div>
<p>Note: Though the resolution is 3 here, in this case it doesn’t matter because both <code>cost</code> and <code>kernel</code> are factors (the resolution for categorical variables is ignored, these parameters always produce a grid over all their valid levels).</p>
<p>This may seem silly, but makes sense when considering that factorial tuning parameters are always <code>character</code> values:</p>
<div class="cell">
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">search_space</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  cost <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"polynomial"</span>, <span class="st">"radial"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/typeof.html">typeof</a></span><span class="op">(</span><span class="va">search_space</span><span class="op">$</span><span class="va">params</span><span class="op">$</span><span class="va">cost</span><span class="op">$</span><span class="va">levels</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "NULL"</code></pre>
</div>
</div>
<p>Be aware that this results in an “unordered” hyperparameter, however. Tuning algorithms that make use of ordering information of parameters, like genetic algorithms or model based optimization, will perform worse when this is done. For these algorithms, it may make more sense to define a <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_dbl()</code></a> or <a href="https://paradox.mlr-org.com/reference/Domain.html"><code>p_int()</code></a> with a more fitting trafo.</p>
<p>An example is the <code>class.weights</code> parameter of the Support Vector Machine (SVM), which takes a named vector of class weights with one entry per target class. If only a few candidate vectors are to be tried, <code>class.weights</code> can be implemented as follows. Note that the <code>levels</code> argument of <code><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct()</a></code> must be named if there is no easy way for <a href="https://www.rdocumentation.org/packages/base/topics/character"><code>as.character()</code></a> to create names:</p>
<div class="cell">
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">search_space</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span></span>
<span>  class.weights <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_fct</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      candidate_a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>spam <span class="op">=</span> <span class="fl">0.5</span>, nonspam <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      candidate_b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>spam <span class="op">=</span> <span class="fl">0.3</span>, nonspam <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">search_space</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$class.weights
   spam nonspam 
    0.5     0.5 


[[2]]
[[2]]$class.weights
   spam nonspam 
    0.3     0.7 </code></pre>
</div>
</div>
</section></section><section id="sec-paradox-tuning-spaces" class="level2" data-number="16.5"><h2 data-number="16.5" class="anchored" data-anchor-id="sec-paradox-tuning-spaces">
<span class="header-section-number">16.5</span> Defining a Tuning Space</h2>
<p>When running an optimization, it is important to inform the tuning algorithm about what hyperparameters are valid. Here the names, types, and valid ranges of each hyperparameter are important. All this information is communicated with objects of the class <a href="https://paradox.mlr-org.com/reference/ParamSet.html"><code>ParamSet</code></a>, which is defined in <a href="https://paradox.mlr-org.com"><code>paradox</code></a>.</p>
<p>Note, that <code>ParamSet</code> objects exist in two contexts. First, parameter set-objects are used to define the space of valid parameter settings for a learner (and other objects). Second, they are used to define a search space for tuning. We are mainly interested in the latter. For example we can consider the <code>minsplit</code> parameter of the <code>lrn("classif.rpart")</code>. The <code>ParamSet</code> associated with the learner has a lower but <em>no</em> upper bound. However, for tuning the value, a lower <em>and</em> upper bound must be given because tuning search spaces need to be bounded. For <a href="https://mlr3.mlr-org.com/reference/Learner.html"><code>Learner</code></a> or <a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html"><code>PipeOp</code></a> objects, typically “unbounded” parameter sets are used. Here, however, we will mainly focus on creating “bounded” parameter sets that can be used for tuning.</p>
<p>How search spaces can be created using <a href="https://paradox.mlr-org.com/reference/ps.html"><code>ps()</code></a> has been outlined in <a href="../chapter4/hyperparameter_optimization.html#sec-tune-ps" class="quarto-xref"><span>Section 4.4.2</span></a>.</p>
<section id="sec-paradox-creation-tuning-paramset-from-learner" class="level3" data-number="16.5.1"><h3 data-number="16.5.1" class="anchored" data-anchor-id="sec-paradox-creation-tuning-paramset-from-learner">
<span class="header-section-number">16.5.1</span> Creating Tuning ParamSets from other ParamSets</h3>
<p>Having to define a tuning <code>ParamSet</code> for a <code>Learner</code> that already has parameter set information may seem unnecessarily tedious, and there is indeed a way to create tuning <code>ParamSet</code>s from a <code>Learner</code>’s parameter set, making use of as much information as already available.</p>
<p>This is done by setting values of a <code>Learner</code>’s <code>ParamSet</code> to so-called <a href="https://paradox.mlr-org.com/reference/to_tune.html"><code>TuneToken</code></a>s, constructed with a <a href="https://paradox.mlr-org.com/reference/to_tune.html"><code>to_tune()</code></a> call. This can be done in the same way that other hyperparameters are set to specific values. It can be understood as the hyperparameters being tagged for later tuning. The resulting <code>ParamSet</code> used for tuning can be retrieved using the <code>$search_space()</code> method.</p>
<div class="cell">
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://mlr3learners.mlr-org.com">"mlr3learners"</a></span><span class="op">)</span></span>
<span><span class="va">learner</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html">lrn</a></span><span class="op">(</span><span class="st">"classif.svm"</span><span class="op">)</span></span>
<span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">kernel</span> <span class="op">=</span> <span class="st">"polynomial"</span> <span class="co"># for example</span></span>
<span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">degree</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">1</span>, upper <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(1)&gt;
       id    class lower upper nlevels        default  value
1: degree ParamInt     1     3       3 &lt;NoDefault[0]&gt; [NULL]</code></pre>
</div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span></span>
<span>  <span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   degree
1:      1
2:      2
3:      3</code></pre>
</div>
</div>
<p>It is possible to omit <code>lower</code> here, because it can be inferred from the lower bound of the <code>degree</code> parameter itself. For other parameters, that are already bounded, it is possible to not give any bounds at all, because their ranges are already bounded. An example is the logical <code>$shrinking</code> hyperparameter:</p>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">shrinking</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(2)&gt;
          id    class lower upper nlevels        default  value
1:    degree ParamInt     1     3       3 &lt;NoDefault[0]&gt; [NULL]
2: shrinking ParamLgl    NA    NA       2           TRUE [NULL]</code></pre>
</div>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span></span>
<span>  <span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   degree shrinking
1:      1      TRUE
2:      1     FALSE
3:      2      TRUE
4:      2     FALSE
5:      3      TRUE
6:      3     FALSE</code></pre>
</div>
</div>
<p><code><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune()</a></code> can also be constructed with a <code>Domain</code> object, i.e.&nbsp;something constructed with a <code>p_***</code> call. This way it is possible to tune continuous parameters with discrete values, or to give trafos or dependencies. One could, for example, tune the <code>$cost</code> as above on three given special values, and introduce a dependency of <code>$shrinking</code> on it. Notice that <code>to_tune(&lt;levels&gt;)</code> is a short form of <code>to_tune(p_fct(&lt;levels&gt;))</code>. When introducing the dependency, we need to use the <code>cost</code> value from <em>before</em> the implicit trafo, which is the name or <a href="https://www.rdocumentation.org/packages/base/topics/character"><code>as.character()</code></a> of the respective value, here <code>"val2"</code>!</p>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">cost</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>val1 <span class="op">=</span> <span class="fl">0.3</span>, val2 <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">shrinking</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_lgl</a></span><span class="op">(</span>depends <span class="op">=</span> <span class="va">cost</span> <span class="op">==</span> <span class="st">"val2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(3)&gt;
          id    class lower upper nlevels        default parents  value
1:      cost ParamFct    NA    NA       2 &lt;NoDefault[0]&gt;  [NULL] [NULL]
2:    degree ParamInt     1     3       3 &lt;NoDefault[0]&gt;  [NULL] [NULL]
3: shrinking ParamLgl    NA    NA       2 &lt;NoDefault[0]&gt;    cost [NULL]
Trafo is set.</code></pre>
</div>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   cost degree shrinking
1:  0.3      1        NA
2:  0.3      2        NA
3:  0.3      3        NA
4:  0.7      1      TRUE
5:  0.7      1     FALSE
6:  0.7      2      TRUE
7:  0.7      2     FALSE
8:  0.7      3      TRUE
9:  0.7      3     FALSE</code></pre>
</div>
</div>
<p>The <code>$search_space()</code> picks up dependencies from the underlying <code>ParamSet</code> automatically. So if the <code>kernel</code> is tuned, then <code>degree</code> automatically gets the dependency on it, without us having to specify that. (Here we reset <code>$cost</code> and <code>$shrinking</code> to <code>NULL</code> for the sake of clarity of the generated output.)</p>
<div class="cell">
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">cost</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">shrinking</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">kernel</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"polynomial"</span>, <span class="st">"radial"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ParamSet(2)&gt;
       id    class lower upper nlevels        default parents  value
1: degree ParamInt     1     3       3 &lt;NoDefault[0]&gt;  kernel [NULL]
2: kernel ParamFct    NA    NA       2 &lt;NoDefault[0]&gt;  [NULL] [NULL]</code></pre>
</div>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">rbindlist</span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   degree     kernel
1:      1 polynomial
2:     NA     radial
3:      2 polynomial
4:      3 polynomial</code></pre>
</div>
</div>
<p>It is even possible to define whole <code>ParamSet</code>s that get tuned over for a single parameter. This may be especially useful for vector hyperparameters that should be searched along multiple dimensions. This parameter set must, however, have an <code>.extra_trafo</code> that returns a list with a single element, because it corresponds to a single hyperparameter that is being tuned. Suppose the <code>$class.weights</code> hyperparameter should be tuned along two dimensions:</p>
<div class="cell">
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="va">values</span><span class="op">$</span><span class="va">class.weights</span> <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/to_tune.html">to_tune</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html">ps</a></span><span class="op">(</span>spam <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>, nonspam <span class="op">=</span> <span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html">p_dbl</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    .extra_trafo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param_set</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>spam <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">spam</span>, nonspam <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">nonspam</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/generate_design_grid.html">generate_design_grid</a></span><span class="op">(</span><span class="va">learner</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">search_space</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="fu">transpose</span><span class="op">(</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$degree
[1] 1

[[1]]$kernel
[1] "polynomial"

[[1]]$class.weights
   spam nonspam 
    0.1     0.1 


[[2]]
[[2]]$kernel
[1] "radial"

[[2]]$class.weights
   spam nonspam 
    0.1     0.1 


[[3]]
[[3]]$degree
[1] 2

[[3]]$kernel
[1] "polynomial"

[[3]]$class.weights
   spam nonspam 
    0.1     0.1 </code></pre>
</div>
</div>
</section></section><section id="citation" class="level2" data-number="16.6"><h2 data-number="16.6" class="anchored" data-anchor-id="citation">
<span class="header-section-number">16.6</span> Citation</h2>
<p>Please cite this chapter as:</p>
<p>Binder M, Fischer S, Lang M, Winterstetter A. (2024). Advanced Hyperparameter Specification using paradox. In Bischl B, Sonabend R, Kotthoff L, Lang M, (Eds.), <em>Applied Machine Learning Using mlr3 in R</em>. CRC Press. https://mlr3book.mlr-org.com/advanced_hyperparameter_specification_using_paradox.html.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode bibtex code-with-copy"><code class="sourceCode bibtex"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="va">@incollection</span>{<span class="ot">citekey</span>,</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">author</span> = "<span class="st">Martin Binder and Sebastian Fischer and Michel Lang and Alexander Winterstetter</span>",</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">title</span> = "<span class="st">Advanced Hyperparameter Specification using paradox</span>",</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">booktitle</span> = "<span class="st">Applied Machine Learning Using {m}lr3 in {R}</span>",</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">publisher</span> = "<span class="st">CRC Press</span>", <span class="st">year</span> = "<span class="st">2024</span>",</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">editor</span> = "<span class="st">Bernd Bischl and Raphael Sonabend and Lars Kotthoff and Michel Lang</span>",</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">url</span> = "<span class="st">https://mlr3book.mlr-org.com/advanced_hyperparameter_specification_using_paradox.html</span>"</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/chapter15/predsets_valid_inttune.html" class="pagination-link" aria-label="Predict Sets, Validation and Internal Tuning (+)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Predict Sets, Validation and Internal Tuning (+)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">References</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb127" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="an">aliases:</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co">  - "/advanced_hyperparameter_specification_using_paradox.html"</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Advanced Hyperparameter Specification using paradox {#sec-paradox}</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>{{&lt; include ../../common/_setup.qmd &gt;}}</span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="in">`r chapter = "Advanced Hyperparameter Specification using paradox"`</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a><span class="in">`r authors(chapter)`</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>In previous chapters, we have already outlined how hyperparameters can be set manually (@sec-param-set) or optimized automatically (@sec-optimization).</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>In this chapter, we will introduce the <span class="in">`r paradox`</span> package, which offers a language for the description of parameter spaces, as well as tools for useful operations on these parameter spaces.</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>A parameter space is often useful when describing:</span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>A set of sensible input values for an R function</span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The set of possible values that fields of a configuration object can take</span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The search space of an optimization process</span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>The tools provided by <span class="in">`paradox`</span> therefore relate to:</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Parameter checking: Verifying that a set of parameters satisfies the conditions of a parameter space</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Parameter sampling: Generating parameter values that lie in the parameter space for systematic exploration of program behavior depending on these parameters</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a><span class="in">`paradox`</span> is, by nature, an auxiliary package that derives its usefulness from other packages that make use of it.</span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>It is heavily utilized in other packages of the <span class="in">`mlr3`</span> ecosystem such as <span class="in">`r mlr3`</span>, <span class="in">`r mlr3pipelines`</span>, <span class="in">`r mlr3tuning`</span>, and <span class="in">`r ref_pkg("miesmuschel")`</span>.</span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference Based Objects</span></span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>It is important to know that some objects created in <span class="in">`r paradox`</span> are "reference-based", unlike most other objects in R.</span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>When a change is made to a <span class="in">`r ref("ParamSet")`</span> object, for example by changing the <span class="in">`$values`</span> field, all variables that point to this parameter set will contain the changed object.</span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a>To create an independent copy of a parameter set, the <span class="in">`$clone(deep = TRUE)`</span> method needs to be used:</span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-001}</span></span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"paradox"</span>)</span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a>ps1 <span class="ot">=</span> <span class="fu">ps</span>(<span class="at">a =</span> <span class="fu">p_int</span>(<span class="at">init =</span> <span class="dv">1</span>))</span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a>ps2 <span class="ot">=</span> ps1</span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>ps3 <span class="ot">=</span> ps1<span class="sc">$</span><span class="fu">clone</span>(<span class="at">deep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps1)</span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a>At this point, <span class="in">`ps1`</span>, <span class="in">`ps2`</span>, and <span class="in">`ps3`</span> all contain the same values.</span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a>Now we change the value of <span class="in">`a`</span> in <span class="in">`ps1`</span>:</span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-002}</span></span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true" tabindex="-1"></a>ps1<span class="sc">$</span>values<span class="sc">$</span>a <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps1)</span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps2)</span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps3)</span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-56"><a href="#cb127-56" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`ps2`</span> holds the same reference as <span class="in">`ps1`</span>, the change is reflected in <span class="in">`ps2`</span> as well.</span>
<span id="cb127-57"><a href="#cb127-57" aria-hidden="true" tabindex="-1"></a>However, <span class="in">`ps3`</span> is an independent clone of the original <span class="in">`ps1`</span> and still has <span class="in">`a`</span> set to <span class="in">`1`</span>.</span>
<span id="cb127-58"><a href="#cb127-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-59"><a href="#cb127-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## Defining a Parameter Space</span></span>
<span id="cb127-60"><a href="#cb127-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-61"><a href="#cb127-61" aria-hidden="true" tabindex="-1"></a><span class="fu">### `Domain` Representing Single Parameters</span></span>
<span id="cb127-62"><a href="#cb127-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-63"><a href="#cb127-63" aria-hidden="true" tabindex="-1"></a>Parameter spaces are made up of individual parameters, which usually can take a single atomic value.</span>
<span id="cb127-64"><a href="#cb127-64" aria-hidden="true" tabindex="-1"></a>Consider, for example, trying to configure the <span class="in">`r ref_pkg("rpart")`</span> package's <span class="in">`rpart::rpart.control()`</span> object.</span>
<span id="cb127-65"><a href="#cb127-65" aria-hidden="true" tabindex="-1"></a>It has various components (<span class="in">`minsplit`</span>, <span class="in">`cp`</span>, ...) that all take a single value.</span>
<span id="cb127-66"><a href="#cb127-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-67"><a href="#cb127-67" aria-hidden="true" tabindex="-1"></a>These components are represented by <span class="in">`r ref("Domain")`</span> objects, which can be created using the sugar functions in @tbl-paradox-define.</span>
<span id="cb127-68"><a href="#cb127-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-69"><a href="#cb127-69" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Constructor      <span class="pp">|</span> Description                          <span class="pp">|</span> Underlying Class <span class="pp">|</span></span>
<span id="cb127-70"><a href="#cb127-70" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------------|--------------------------------------|------------------|</span></span>
<span id="cb127-71"><a href="#cb127-71" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`r ref("p_dbl")`</span> <span class="pp">|</span> Real valued parameter ("double")     <span class="pp">|</span> <span class="in">`ParamDbl`</span>       <span class="pp">|</span></span>
<span id="cb127-72"><a href="#cb127-72" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`r ref("p_int")`</span> <span class="pp">|</span> Integer parameter                    <span class="pp">|</span> <span class="in">`ParamInt`</span>       <span class="pp">|</span></span>
<span id="cb127-73"><a href="#cb127-73" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`r ref("p_fct")`</span> <span class="pp">|</span> Discrete valued parameter ("factor") <span class="pp">|</span> <span class="in">`ParamFct`</span>       <span class="pp">|</span></span>
<span id="cb127-74"><a href="#cb127-74" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`r ref("p_lgl")`</span> <span class="pp">|</span> Logical / Boolean parameter          <span class="pp">|</span> <span class="in">`ParamLgl`</span>       <span class="pp">|</span></span>
<span id="cb127-75"><a href="#cb127-75" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`r ref("p_uty")`</span> <span class="pp">|</span> Untyped parameter                    <span class="pp">|</span> <span class="in">`ParamUty`</span>       <span class="pp">|</span></span>
<span id="cb127-76"><a href="#cb127-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-77"><a href="#cb127-77" aria-hidden="true" tabindex="-1"></a>: <span class="in">`Domain`</span> Constructors and their resulting <span class="in">`Domain`</span>. {#tbl-paradox-define}</span>
<span id="cb127-78"><a href="#cb127-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-79"><a href="#cb127-79" aria-hidden="true" tabindex="-1"></a>A <span class="in">`r ref("ParamSet")`</span> that represents a given set of parameters is created by calling <span class="in">`r ref("ps()")`</span> with named arguments that are <span class="in">`Domain`</span> objects.</span>
<span id="cb127-80"><a href="#cb127-80" aria-hidden="true" tabindex="-1"></a>While domain objects themselves are R objects that can in principle be handled and manipulated, they should not be changed after construction.</span>
<span id="cb127-81"><a href="#cb127-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-82"><a href="#cb127-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-003}</span></span>
<span id="cb127-83"><a href="#cb127-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"paradox"</span>)</span>
<span id="cb127-84"><a href="#cb127-84" aria-hidden="true" tabindex="-1"></a>param_set <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-85"><a href="#cb127-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">parA =</span> <span class="fu">p_lgl</span>(<span class="at">init =</span> <span class="cn">FALSE</span>),</span>
<span id="cb127-86"><a href="#cb127-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">parB =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">tags =</span> <span class="fu">c</span>(<span class="st">"tag1"</span>, <span class="st">"tag2"</span>)),</span>
<span id="cb127-87"><a href="#cb127-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">parC =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">4</span>, <span class="at">special_vals =</span> <span class="fu">list</span>(<span class="cn">NULL</span>)),</span>
<span id="cb127-88"><a href="#cb127-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">parD =</span> <span class="fu">p_fct</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>), <span class="at">default =</span> <span class="st">"y"</span>),</span>
<span id="cb127-89"><a href="#cb127-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">parE =</span> <span class="fu">p_uty</span>(<span class="at">custom_check =</span> <span class="cf">function</span>(x) checkmate<span class="sc">::</span><span class="fu">checkFunction</span>(x))</span>
<span id="cb127-90"><a href="#cb127-90" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-91"><a href="#cb127-91" aria-hidden="true" tabindex="-1"></a>param_set</span>
<span id="cb127-92"><a href="#cb127-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-93"><a href="#cb127-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-94"><a href="#cb127-94" aria-hidden="true" tabindex="-1"></a>Every parameter can have:</span>
<span id="cb127-95"><a href="#cb127-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-96"><a href="#cb127-96" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**default** - A default value, indicating the behavior of something if the specific value is not given.</span>
<span id="cb127-97"><a href="#cb127-97" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**init** - An initial value, which is set in <span class="in">`$values`</span> when the <span class="in">`ParamSet`</span> is created.</span>
<span id="cb127-98"><a href="#cb127-98" aria-hidden="true" tabindex="-1"></a>  Note, that this is not the same as <span class="in">`default`</span>: <span class="in">`default`</span> is used when a parameter is not present in <span class="in">`$values`</span>, while <span class="in">`init`</span> is the value that is set upon creation.</span>
<span id="cb127-99"><a href="#cb127-99" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**special_vals** - A list of values that are accepted even if they do not conform to the type.</span>
<span id="cb127-100"><a href="#cb127-100" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**tags** - Tags that can be used to organize parameters.</span>
<span id="cb127-101"><a href="#cb127-101" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**trafo** - A transformation function that is applied to the parameter value after it has been sampled.</span>
<span id="cb127-102"><a href="#cb127-102" aria-hidden="true" tabindex="-1"></a>  It is for example used through the <span class="in">`Design$transpose()`</span> function after a <span class="in">`r ref("Design")`</span> was created by <span class="in">`r ref("generate_design_random()")`</span> or similar functions.</span>
<span id="cb127-103"><a href="#cb127-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-104"><a href="#cb127-104" aria-hidden="true" tabindex="-1"></a>The numeric (<span class="in">`p_int()`</span> and <span class="in">`p_dbl()`</span>) parameters furthermore allow for specification of a **lower** and **upper** bound.</span>
<span id="cb127-105"><a href="#cb127-105" aria-hidden="true" tabindex="-1"></a>Meanwhile, the <span class="in">`p_fct()`</span> parameter must be given a vector of **levels** that define the possible states its parameter can take.</span>
<span id="cb127-106"><a href="#cb127-106" aria-hidden="true" tabindex="-1"></a>The <span class="in">`p_uty()`</span> parameter can also have a **`custom_check`** function that must return <span class="in">`TRUE`</span> when a value is acceptable and may return a <span class="in">`character(1)`</span> error description otherwise.</span>
<span id="cb127-107"><a href="#cb127-107" aria-hidden="true" tabindex="-1"></a>The example above defines <span class="in">`parE`</span> as a parameter that only accepts functions.</span>
<span id="cb127-108"><a href="#cb127-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-109"><a href="#cb127-109" aria-hidden="true" tabindex="-1"></a>All values which are given to the constructor are then accessible from the <span class="in">`ParamSet`</span> for inspection using <span class="in">`$`</span>.</span>
<span id="cb127-110"><a href="#cb127-110" aria-hidden="true" tabindex="-1"></a>The parameter set should be considered immutable, except for some fields such as <span class="in">`$values`</span>, <span class="in">`$deps`</span>, <span class="in">`$tags`</span>.</span>
<span id="cb127-111"><a href="#cb127-111" aria-hidden="true" tabindex="-1"></a>Bounds and levels should not be changed after construction.</span>
<span id="cb127-112"><a href="#cb127-112" aria-hidden="true" tabindex="-1"></a>Instead, a new <span class="in">`ParamSet`</span> should be constructed.</span>
<span id="cb127-113"><a href="#cb127-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-114"><a href="#cb127-114" aria-hidden="true" tabindex="-1"></a>Besides the possible values that can be given to a constructor, there are also the <span class="in">`$class`</span>, <span class="in">`$nlevels`</span>, <span class="in">`$is_bounded`</span>, <span class="in">`$has_default`</span>, <span class="in">`$storage_type`</span>, <span class="in">`$is_number`</span> and <span class="in">`$is_categ`</span> fields that give information about a parameter.</span>
<span id="cb127-115"><a href="#cb127-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-116"><a href="#cb127-116" aria-hidden="true" tabindex="-1"></a>A list of all fields can be found in <span class="in">`?ParamSet`</span>.</span>
<span id="cb127-117"><a href="#cb127-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-118"><a href="#cb127-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-004}</span></span>
<span id="cb127-119"><a href="#cb127-119" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span>lower</span>
<span id="cb127-120"><a href="#cb127-120" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span>levels<span class="sc">$</span>parD</span>
<span id="cb127-121"><a href="#cb127-121" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span>class</span>
<span id="cb127-122"><a href="#cb127-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-123"><a href="#cb127-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-124"><a href="#cb127-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-125"><a href="#cb127-125" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Type / Range Checking</span></span>
<span id="cb127-126"><a href="#cb127-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-127"><a href="#cb127-127" aria-hidden="true" tabindex="-1"></a>The <span class="in">`ParamSet`</span> object offers the possibility to check whether a value satisfies its condition, i.e. is of the right type, and also falls within the range of allowed values, using the <span class="in">`$test()`</span>, <span class="in">`$check()`</span>, and <span class="in">`$assert()`</span> functions.</span>
<span id="cb127-128"><a href="#cb127-128" aria-hidden="true" tabindex="-1"></a>Their argument must be a named list with values that are checked against the respective parameters, and it is possible to check only a subset of parameters.</span>
<span id="cb127-129"><a href="#cb127-129" aria-hidden="true" tabindex="-1"></a><span class="in">`$test()`</span> should be used within conditional checks and returns <span class="in">`TRUE`</span> or <span class="in">`FALSE`</span>, while <span class="in">`$check()`</span> returns an error description when a value does not conform to the parameter (and thus plays well with the <span class="in">`r ref("checkmate::assert()")`</span>-function).</span>
<span id="cb127-130"><a href="#cb127-130" aria-hidden="true" tabindex="-1"></a><span class="in">`$assert()`</span> will throw an error whenever a value does not fit.</span>
<span id="cb127-131"><a href="#cb127-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-132"><a href="#cb127-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-005}</span></span>
<span id="cb127-133"><a href="#cb127-133" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span><span class="fu">test</span>(<span class="fu">list</span>(<span class="at">parA =</span> <span class="cn">FALSE</span>, <span class="at">parB =</span> <span class="dv">0</span>))</span>
<span id="cb127-134"><a href="#cb127-134" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span><span class="fu">test</span>(<span class="fu">list</span>(<span class="at">parA =</span> <span class="st">"FALSE"</span>))</span>
<span id="cb127-135"><a href="#cb127-135" aria-hidden="true" tabindex="-1"></a>param_set<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">parA =</span> <span class="st">"FALSE"</span>))</span>
<span id="cb127-136"><a href="#cb127-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-137"><a href="#cb127-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-138"><a href="#cb127-138" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parameter Sets</span></span>
<span id="cb127-139"><a href="#cb127-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-140"><a href="#cb127-140" aria-hidden="true" tabindex="-1"></a>The ordered collection of parameters is handled in a <span class="in">`ParamSet`</span>.</span>
<span id="cb127-141"><a href="#cb127-141" aria-hidden="true" tabindex="-1"></a>It is typically created by calling <span class="in">`ps()`</span>, but can also be initialized using the <span class="in">`ParamSet$new()`</span> function.</span>
<span id="cb127-142"><a href="#cb127-142" aria-hidden="true" tabindex="-1"></a>The main difference is that <span class="in">`ps()`</span> takes named arguments, whereas <span class="in">`ParamSet$new()`</span> takes a named list.</span>
<span id="cb127-143"><a href="#cb127-143" aria-hidden="true" tabindex="-1"></a>The latter makes it easier to construct a parameter set programmatically, but is slightly more verbose.</span>
<span id="cb127-144"><a href="#cb127-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-145"><a href="#cb127-145" aria-hidden="true" tabindex="-1"></a><span class="in">`ParamSet`</span>s can be combined using <span class="in">`c()`</span> or <span class="in">`r ref("ps_union()")`</span> (the latter of which takes a list), and they have a <span class="in">`$subset()`</span> method that allows for subsetting.</span>
<span id="cb127-146"><a href="#cb127-146" aria-hidden="true" tabindex="-1"></a>All of these functions return a new, cloned parameter set-object, and do not modify the original parameter set.</span>
<span id="cb127-147"><a href="#cb127-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-148"><a href="#cb127-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-006}</span></span>
<span id="cb127-149"><a href="#cb127-149" aria-hidden="true" tabindex="-1"></a>ps1 <span class="ot">=</span> ParamSet<span class="sc">$</span><span class="fu">new</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="fu">p_int</span>(), <span class="at">y =</span> <span class="fu">p_dbl</span>()))</span>
<span id="cb127-150"><a href="#cb127-150" aria-hidden="true" tabindex="-1"></a>ps2 <span class="ot">=</span> ParamSet<span class="sc">$</span><span class="fu">new</span>(<span class="fu">list</span>(<span class="at">z =</span> <span class="fu">p_fct</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>))))</span>
<span id="cb127-151"><a href="#cb127-151" aria-hidden="true" tabindex="-1"></a>ps_all <span class="ot">=</span> <span class="fu">c</span>(ps1, ps2)</span>
<span id="cb127-152"><a href="#cb127-152" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps_all)</span>
<span id="cb127-153"><a href="#cb127-153" aria-hidden="true" tabindex="-1"></a>ps_all<span class="sc">$</span><span class="fu">subset</span>(<span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"z"</span>))</span>
<span id="cb127-154"><a href="#cb127-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-155"><a href="#cb127-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-156"><a href="#cb127-156" aria-hidden="true" tabindex="-1"></a><span class="in">`ParamSet`</span>s of each individual parameters can be accessed through the <span class="in">`$subspaces()`</span> function by returning a named list of single-parameter <span class="in">`ParamSets`</span>s.</span>
<span id="cb127-157"><a href="#cb127-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-158"><a href="#cb127-158" aria-hidden="true" tabindex="-1"></a>It is possible to get the <span class="in">`ParamSet`</span> as a <span class="in">`r ref("data.table")`</span> using <span class="in">`as.data.table()`</span>.</span>
<span id="cb127-159"><a href="#cb127-159" aria-hidden="true" tabindex="-1"></a>This makes it easy to subset parameters on certain conditions and aggregate information about them, using the variety of methods provided by <span class="in">`r ref_pkg("data.table")`</span>.</span>
<span id="cb127-160"><a href="#cb127-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-161"><a href="#cb127-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-007}</span></span>
<span id="cb127-162"><a href="#cb127-162" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(ps_all)</span>
<span id="cb127-163"><a href="#cb127-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-164"><a href="#cb127-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-165"><a href="#cb127-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-166"><a href="#cb127-166" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Values in a `ParamSet`</span></span>
<span id="cb127-167"><a href="#cb127-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-168"><a href="#cb127-168" aria-hidden="true" tabindex="-1"></a>Although a <span class="in">`ParamSet`</span> fundamentally represents a value space, it also has a field <span class="in">`$values`</span> that can contain a point within that space.</span>
<span id="cb127-169"><a href="#cb127-169" aria-hidden="true" tabindex="-1"></a>This is useful because many things that define a parameter space need similar operations (like parameter checking) that can be simplified.</span>
<span id="cb127-170"><a href="#cb127-170" aria-hidden="true" tabindex="-1"></a>The <span class="in">`$values`</span> field contains a named list that is always checked against parameter constraints.</span>
<span id="cb127-171"><a href="#cb127-171" aria-hidden="true" tabindex="-1"></a>When trying to set parameter values, e.g. for <span class="in">`r mlr3`</span> <span class="in">`r ref("Learner")`</span>s, it is the <span class="in">`$values`</span> field of its <span class="in">`$param_set`</span> that needs to be used.</span>
<span id="cb127-172"><a href="#cb127-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-173"><a href="#cb127-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-008}</span></span>
<span id="cb127-174"><a href="#cb127-174" aria-hidden="true" tabindex="-1"></a>ps1<span class="sc">$</span>values <span class="ot">=</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fl">1.5</span>)</span>
<span id="cb127-175"><a href="#cb127-175" aria-hidden="true" tabindex="-1"></a>ps1<span class="sc">$</span>values<span class="sc">$</span>y <span class="ot">=</span> <span class="fl">2.5</span></span>
<span id="cb127-176"><a href="#cb127-176" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps1<span class="sc">$</span>values)</span>
<span id="cb127-177"><a href="#cb127-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-178"><a href="#cb127-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-179"><a href="#cb127-179" aria-hidden="true" tabindex="-1"></a>The parameter constraints are automatically checked:</span>
<span id="cb127-180"><a href="#cb127-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-181"><a href="#cb127-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-009, error = TRUE}</span></span>
<span id="cb127-182"><a href="#cb127-182" aria-hidden="true" tabindex="-1"></a>ps1<span class="sc">$</span>values<span class="sc">$</span>x <span class="ot">=</span> <span class="fl">1.5</span></span>
<span id="cb127-183"><a href="#cb127-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-184"><a href="#cb127-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-185"><a href="#cb127-185" aria-hidden="true" tabindex="-1"></a>To set multiple values at once we recommend using <span class="in">`$set_values()`</span>, which updates the given hyperparameters (argument names) with the respective values.</span>
<span id="cb127-186"><a href="#cb127-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-187"><a href="#cb127-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-010}</span></span>
<span id="cb127-188"><a href="#cb127-188" aria-hidden="true" tabindex="-1"></a>ps1<span class="sc">$</span><span class="fu">set_values</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span>)</span>
<span id="cb127-189"><a href="#cb127-189" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps1<span class="sc">$</span>values)</span>
<span id="cb127-190"><a href="#cb127-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-191"><a href="#cb127-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-192"><a href="#cb127-192" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Dependencies</span></span>
<span id="cb127-193"><a href="#cb127-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-194"><a href="#cb127-194" aria-hidden="true" tabindex="-1"></a>It is often the case that certain parameters are irrelevant or should not be given depending on values of other parameters.</span>
<span id="cb127-195"><a href="#cb127-195" aria-hidden="true" tabindex="-1"></a>An example would be a parameter that switches a certain algorithm feature (for example regularization) on or off, combined with another parameter that controls the behavior of that feature (e.g. a regularization parameter).</span>
<span id="cb127-196"><a href="#cb127-196" aria-hidden="true" tabindex="-1"></a>The second parameter would be said to *depend* on the first parameter having the value <span class="in">`TRUE`</span>.</span>
<span id="cb127-197"><a href="#cb127-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-198"><a href="#cb127-198" aria-hidden="true" tabindex="-1"></a>A dependency can be added using the <span class="in">`$add_dep`</span> method, which takes both the ids of the "depender" and "dependee" parameters as well as a <span class="in">`r ref("Condition")`</span> object.</span>
<span id="cb127-199"><a href="#cb127-199" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Condition`</span> object represents the check to be performed on the "dependee".</span>
<span id="cb127-200"><a href="#cb127-200" aria-hidden="true" tabindex="-1"></a>Currently it can be created using <span class="in">`r ref("CondEqual()")`</span> and <span class="in">`r ref("CondAnyOf()")`</span>.</span>
<span id="cb127-201"><a href="#cb127-201" aria-hidden="true" tabindex="-1"></a>Multiple dependencies can be added, and parameters that depend on others can again be depended on, as long as no cyclic dependencies are introduced.</span>
<span id="cb127-202"><a href="#cb127-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-203"><a href="#cb127-203" aria-hidden="true" tabindex="-1"></a>The consequences of dependencies are twofold:</span>
<span id="cb127-204"><a href="#cb127-204" aria-hidden="true" tabindex="-1"></a>For one, the <span class="in">`$check()`</span>, <span class="in">`$test()`</span>, and <span class="in">`$assert()`</span> functions will reject any value supplied for a parameter if its dependency is not satisfied, when the <span class="in">`check_strict`</span> argument is given as <span class="in">`TRUE`</span>. This differs from simply omitting the parameter, which is always allowed.</span>
<span id="cb127-205"><a href="#cb127-205" aria-hidden="true" tabindex="-1"></a>Furthermore, when sampling or creating grid designs from a <span class="in">`ParamSet`</span>, the dependencies will be respected.</span>
<span id="cb127-206"><a href="#cb127-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-207"><a href="#cb127-207" aria-hidden="true" tabindex="-1"></a>The easiest way to set dependencies is to give the <span class="in">`depends`</span> argument to the <span class="in">`Domain`</span> constructor.</span>
<span id="cb127-208"><a href="#cb127-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-209"><a href="#cb127-209" aria-hidden="true" tabindex="-1"></a>The following example makes parameter <span class="in">`D`</span> depend on parameter <span class="in">`A`</span> being <span class="in">`FALSE`</span>, and parameter <span class="in">`B`</span> depend on parameter <span class="in">`D`</span> being one of <span class="in">`"x"`</span> or <span class="in">`"y"`</span>.</span>
<span id="cb127-210"><a href="#cb127-210" aria-hidden="true" tabindex="-1"></a>This introduces an implicit dependency of <span class="in">`B`</span> on <span class="in">`A`</span> being <span class="in">`FALSE`</span> as well, because <span class="in">`D`</span> does not take any value if <span class="in">`A`</span> is <span class="in">`TRUE`</span>.</span>
<span id="cb127-211"><a href="#cb127-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-212"><a href="#cb127-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-011}</span></span>
<span id="cb127-213"><a href="#cb127-213" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-214"><a href="#cb127-214" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">p_lgl</span>(<span class="at">init =</span> <span class="cn">FALSE</span>),</span>
<span id="cb127-215"><a href="#cb127-215" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">p_int</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">10</span>, <span class="at">depends =</span> D <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>)),</span>
<span id="cb127-216"><a href="#cb127-216" aria-hidden="true" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">4</span>),</span>
<span id="cb127-217"><a href="#cb127-217" aria-hidden="true" tabindex="-1"></a>  <span class="at">D =</span> <span class="fu">p_fct</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>), <span class="at">depends =</span> A <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-218"><a href="#cb127-218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-219"><a href="#cb127-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-220"><a href="#cb127-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-221"><a href="#cb127-221" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`depends`</span> argument is limited to operators <span class="in">`==`</span> and <span class="in">`%in%`</span>, so <span class="in">`D = p_fct(..., depends = !A)`</span> would not work.</span>
<span id="cb127-222"><a href="#cb127-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-223"><a href="#cb127-223" aria-hidden="true" tabindex="-1"></a>All dependencies are met, so the check passes:</span>
<span id="cb127-224"><a href="#cb127-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-225"><a href="#cb127-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012a}</span></span>
<span id="cb127-226"><a href="#cb127-226" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">FALSE</span>, <span class="at">D =</span> <span class="st">"x"</span>, <span class="at">B =</span> <span class="dv">1</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-227"><a href="#cb127-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-228"><a href="#cb127-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-229"><a href="#cb127-229" aria-hidden="true" tabindex="-1"></a><span class="in">`B`</span>'s dependency on <span class="in">`D %in% c("x", "y")`</span> is not met because <span class="in">`D`</span> is <span class="in">`"z"`</span>:</span>
<span id="cb127-230"><a href="#cb127-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-231"><a href="#cb127-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012b}</span></span>
<span id="cb127-232"><a href="#cb127-232" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">FALSE</span>, <span class="at">D =</span> <span class="st">"z"</span>, <span class="at">B =</span> <span class="dv">1</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-233"><a href="#cb127-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-234"><a href="#cb127-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-235"><a href="#cb127-235" aria-hidden="true" tabindex="-1"></a><span class="in">`B`</span>'s dependency is not met because <span class="in">`D`</span> is absent:</span>
<span id="cb127-236"><a href="#cb127-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-237"><a href="#cb127-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012c}</span></span>
<span id="cb127-238"><a href="#cb127-238" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">FALSE</span>, <span class="at">B =</span> <span class="dv">1</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-239"><a href="#cb127-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-240"><a href="#cb127-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-241"><a href="#cb127-241" aria-hidden="true" tabindex="-1"></a><span class="in">`B`</span> is absent, so its dependency does not apply:</span>
<span id="cb127-242"><a href="#cb127-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-243"><a href="#cb127-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012d}</span></span>
<span id="cb127-244"><a href="#cb127-244" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">FALSE</span>, <span class="at">D =</span> <span class="st">"z"</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-245"><a href="#cb127-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-246"><a href="#cb127-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-247"><a href="#cb127-247" aria-hidden="true" tabindex="-1"></a>Neither <span class="in">`B`</span> nor <span class="in">`D`</span> are present, so no dependencies are violated:</span>
<span id="cb127-248"><a href="#cb127-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-249"><a href="#cb127-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012e}</span></span>
<span id="cb127-250"><a href="#cb127-250" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">TRUE</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-251"><a href="#cb127-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-252"><a href="#cb127-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-253"><a href="#cb127-253" aria-hidden="true" tabindex="-1"></a><span class="in">`D`</span>'s dependency on <span class="in">`A == FALSE`</span> is not met:</span>
<span id="cb127-254"><a href="#cb127-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-255"><a href="#cb127-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012f}</span></span>
<span id="cb127-256"><a href="#cb127-256" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">TRUE</span>, <span class="at">D =</span> <span class="st">"x"</span>, <span class="at">B =</span> <span class="dv">1</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-257"><a href="#cb127-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-258"><a href="#cb127-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-259"><a href="#cb127-259" aria-hidden="true" tabindex="-1"></a><span class="in">`B`</span>'s dependency is not met because <span class="in">`D`</span> is not present (and cannot be, since <span class="in">`A`</span> is <span class="in">`TRUE`</span>):</span>
<span id="cb127-260"><a href="#cb127-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-261"><a href="#cb127-261" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-012g}</span></span>
<span id="cb127-262"><a href="#cb127-262" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span><span class="fu">check</span>(<span class="fu">list</span>(<span class="at">A =</span> <span class="cn">TRUE</span>, <span class="at">B =</span> <span class="dv">1</span>), <span class="at">check_strict =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-263"><a href="#cb127-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-264"><a href="#cb127-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-265"><a href="#cb127-265" aria-hidden="true" tabindex="-1"></a>Internally, the dependencies are represented as a <span class="in">`data.table`</span>, which can be accessed listed in the <span class="in">`$deps`</span> field.</span>
<span id="cb127-266"><a href="#cb127-266" aria-hidden="true" tabindex="-1"></a>This <span class="in">`data.table`</span> can even be mutated, to e.g. remove dependencies.</span>
<span id="cb127-267"><a href="#cb127-267" aria-hidden="true" tabindex="-1"></a>There are no sanity checks done when the <span class="in">`$deps`</span> field is changed this way.</span>
<span id="cb127-268"><a href="#cb127-268" aria-hidden="true" tabindex="-1"></a>Therefore it is advised to be cautious.</span>
<span id="cb127-269"><a href="#cb127-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-270"><a href="#cb127-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-013}</span></span>
<span id="cb127-271"><a href="#cb127-271" aria-hidden="true" tabindex="-1"></a>p<span class="sc">$</span>deps</span>
<span id="cb127-272"><a href="#cb127-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-273"><a href="#cb127-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-274"><a href="#cb127-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vector Parameters</span></span>
<span id="cb127-275"><a href="#cb127-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-276"><a href="#cb127-276" aria-hidden="true" tabindex="-1"></a>There are no vectorial parameters in <span class="in">`r paradox`</span>.</span>
<span id="cb127-277"><a href="#cb127-277" aria-hidden="true" tabindex="-1"></a>Instead, it is now possible to create multiple copies of a single parameter using the <span class="in">`r ref("ps_replicate()")`</span> function.</span>
<span id="cb127-278"><a href="#cb127-278" aria-hidden="true" tabindex="-1"></a>This creates a <span class="in">`ParamSet`</span> consisting of multiple copies of the parameter, which can then (optionally) be added to another <span class="in">`ParamSet`</span>.</span>
<span id="cb127-279"><a href="#cb127-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-280"><a href="#cb127-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-014}</span></span>
<span id="cb127-281"><a href="#cb127-281" aria-hidden="true" tabindex="-1"></a>ps2d <span class="ot">=</span> <span class="fu">ps_replicate</span>(<span class="fu">ps</span>(<span class="at">x =</span> <span class="fu">p_dbl</span>(<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>)), <span class="dv">2</span>)</span>
<span id="cb127-282"><a href="#cb127-282" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ps2d)</span>
<span id="cb127-283"><a href="#cb127-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-284"><a href="#cb127-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-285"><a href="#cb127-285" aria-hidden="true" tabindex="-1"></a>It is also possible to use a <span class="in">`p_uty()`</span> to accept vectorial parameters, which also works for parameters of variable length.</span>
<span id="cb127-286"><a href="#cb127-286" aria-hidden="true" tabindex="-1"></a>A <span class="in">`ParamSet`</span> containing a <span class="in">`p_uty()`</span> can be used for parameter checking, but not for sampling.</span>
<span id="cb127-287"><a href="#cb127-287" aria-hidden="true" tabindex="-1"></a>To sample values for a method that needs a vectorial parameter, it is advised to use an <span class="in">`$.extra_trafo`</span> transformation function that creates a vector from atomic values.</span>
<span id="cb127-288"><a href="#cb127-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-289"><a href="#cb127-289" aria-hidden="true" tabindex="-1"></a>Assembling a vector from repeated parameters is aided by the parameter's <span class="in">`$tags`</span>: Parameters that were generated by the <span class="in">`ps_replicate()`</span> command can be tagged as belonging to a group of repeated parameters.</span>
<span id="cb127-290"><a href="#cb127-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-291"><a href="#cb127-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-015}</span></span>
<span id="cb127-292"><a href="#cb127-292" aria-hidden="true" tabindex="-1"></a>ps2d <span class="ot">=</span> <span class="fu">ps_replicate</span>(<span class="fu">ps</span>(<span class="at">x =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> <span class="fu">p_int</span>(<span class="dv">0</span>, <span class="dv">10</span>)), <span class="dv">2</span>, <span class="at">tag_params =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-293"><a href="#cb127-293" aria-hidden="true" tabindex="-1"></a>ps2d<span class="sc">$</span>values <span class="ot">=</span> <span class="fu">list</span>(<span class="at">rep1.x =</span> <span class="fl">0.2</span>, <span class="at">rep2.x =</span> <span class="fl">0.4</span>, <span class="at">rep1.y =</span> <span class="dv">3</span>, <span class="at">rep2.y =</span> <span class="dv">4</span>)</span>
<span id="cb127-294"><a href="#cb127-294" aria-hidden="true" tabindex="-1"></a>ps2d<span class="sc">$</span>tags</span>
<span id="cb127-295"><a href="#cb127-295" aria-hidden="true" tabindex="-1"></a>ps2d<span class="sc">$</span><span class="fu">get_values</span>(<span class="at">tags =</span> <span class="st">"param_x"</span>)</span>
<span id="cb127-296"><a href="#cb127-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-297"><a href="#cb127-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-298"><a href="#cb127-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameter Sampling</span></span>
<span id="cb127-299"><a href="#cb127-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-300"><a href="#cb127-300" aria-hidden="true" tabindex="-1"></a>It is often useful to have a list of possible parameter values that can be systematically iterated through, for example to find parameter values for which an algorithm performs particularly well (tuning).</span>
<span id="cb127-301"><a href="#cb127-301" aria-hidden="true" tabindex="-1"></a><span class="in">`r paradox`</span> offers a variety of functions that allow creating evenly-spaced parameter values in a "grid" design as well as random sampling.</span>
<span id="cb127-302"><a href="#cb127-302" aria-hidden="true" tabindex="-1"></a>In the latter case, it is possible to influence the sampling distribution in more or less fine detail.</span>
<span id="cb127-303"><a href="#cb127-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-304"><a href="#cb127-304" aria-hidden="true" tabindex="-1"></a>A point to always keep in mind while sampling is that only numerical and factorial parameters that are bounded can be sampled from, i.e. not <span class="in">`r ref("p_uty()")`</span>.</span>
<span id="cb127-305"><a href="#cb127-305" aria-hidden="true" tabindex="-1"></a>Furthermore, for most samplers <span class="in">`r ref("p_int()")`</span> and <span class="in">`r ref("p_dbl()")`</span> must have finite lower and upper bounds.</span>
<span id="cb127-306"><a href="#cb127-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-307"><a href="#cb127-307" aria-hidden="true" tabindex="-1"></a><span class="fu">### Parameter Designs</span></span>
<span id="cb127-308"><a href="#cb127-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-309"><a href="#cb127-309" aria-hidden="true" tabindex="-1"></a>Functions that sample the parameter space fundamentally return an object of the <span class="in">`r ref("Design")`</span> class.</span>
<span id="cb127-310"><a href="#cb127-310" aria-hidden="true" tabindex="-1"></a>These objects contain the sampled data as a <span class="in">`data.table`</span> under the <span class="in">`$data`</span> field, and also offer conversion to a list of parameter-values using the <span class="in">`$transpose()`</span> function.</span>
<span id="cb127-311"><a href="#cb127-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-312"><a href="#cb127-312" aria-hidden="true" tabindex="-1"></a><span class="fu">### Grid Design</span></span>
<span id="cb127-313"><a href="#cb127-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-314"><a href="#cb127-314" aria-hidden="true" tabindex="-1"></a>The <span class="in">`r ref("generate_design_grid()")`</span> function is used to create grid designs that contain all combinations of parameter values: All possible values for <span class="in">`r ref("p_lgl()")`</span> and <span class="in">`r ref("p_fct()")`</span>, and values with a given resolution for <span class="in">`p_int()`</span> and <span class="in">`p_dbl()`</span>.</span>
<span id="cb127-315"><a href="#cb127-315" aria-hidden="true" tabindex="-1"></a>The resolution can be given for all numeric parameters, or for specific named parameters through the <span class="in">`param_resolutions`</span> parameter.</span>
<span id="cb127-316"><a href="#cb127-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-317"><a href="#cb127-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-016}</span></span>
<span id="cb127-318"><a href="#cb127-318" aria-hidden="true" tabindex="-1"></a>ps_small <span class="ot">=</span> <span class="fu">ps</span>(<span class="at">A =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">B =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb127-319"><a href="#cb127-319" aria-hidden="true" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">generate_design_grid</span>(ps_small, <span class="dv">2</span>)</span>
<span id="cb127-320"><a href="#cb127-320" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(design)</span>
<span id="cb127-321"><a href="#cb127-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-322"><a href="#cb127-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-323"><a href="#cb127-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-017}</span></span>
<span id="cb127-324"><a href="#cb127-324" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_design_grid</span>(ps_small, <span class="at">param_resolutions =</span> <span class="fu">c</span>(<span class="at">A =</span> <span class="dv">3</span>, <span class="at">B =</span> <span class="dv">2</span>))</span>
<span id="cb127-325"><a href="#cb127-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-326"><a href="#cb127-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-327"><a href="#cb127-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Sampling</span></span>
<span id="cb127-328"><a href="#cb127-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-329"><a href="#cb127-329" aria-hidden="true" tabindex="-1"></a><span class="in">`paradox`</span> offers different methods for random sampling, which vary in the degree to which they can be configured (see @fig-paradox-sampling).</span>
<span id="cb127-330"><a href="#cb127-330" aria-hidden="true" tabindex="-1"></a>The easiest way to get a uniformly random sample of parameters is <span class="in">`r ref("generate_design_random()")`</span>.</span>
<span id="cb127-331"><a href="#cb127-331" aria-hidden="true" tabindex="-1"></a>It is also possible to create latin hypercube sampled parameter values using <span class="in">`r ref("generate_design_lhs()")`</span>, which utilizes the <span class="in">`r ref_pkg("lhs")`</span> package.</span>
<span id="cb127-332"><a href="#cb127-332" aria-hidden="true" tabindex="-1"></a>LHS-sampling creates low-discrepancy sampled values that cover the parameter space more evenly than purely random values.</span>
<span id="cb127-333"><a href="#cb127-333" aria-hidden="true" tabindex="-1"></a><span class="in">`r ref("generate_design_sobol()")`</span> can be used to sample using the Sobol sequence.</span>
<span id="cb127-334"><a href="#cb127-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-335"><a href="#cb127-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-018}</span></span>
<span id="cb127-336"><a href="#cb127-336" aria-hidden="true" tabindex="-1"></a>pvrand <span class="ot">=</span> <span class="fu">generate_design_random</span>(ps_small, <span class="dv">500</span>)</span>
<span id="cb127-337"><a href="#cb127-337" aria-hidden="true" tabindex="-1"></a>pvlhs <span class="ot">=</span> <span class="fu">generate_design_lhs</span>(ps_small, <span class="dv">500</span>)</span>
<span id="cb127-338"><a href="#cb127-338" aria-hidden="true" tabindex="-1"></a>pvsobol <span class="ot">=</span> <span class="fu">generate_design_sobol</span>(ps_small, <span class="dv">500</span>)</span>
<span id="cb127-339"><a href="#cb127-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-340"><a href="#cb127-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-341"><a href="#cb127-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-019, echo = FALSE, fig.width = 4, fig.height = 4}</span></span>
<span id="cb127-342"><a href="#cb127-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-paradox-sampling</span></span>
<span id="cb127-343"><a href="#cb127-343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Comparison of random, latin hypercube, and Sobol sequence sampling designs for a two-dimensional parameter space."</span></span>
<span id="cb127-344"><a href="#cb127-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap:</span></span>
<span id="cb127-345"><a href="#cb127-345" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Random design"</span></span>
<span id="cb127-346"><a href="#cb127-346" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Sobol design"</span></span>
<span id="cb127-347"><a href="#cb127-347" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "LHS design"</span></span>
<span id="cb127-348"><a href="#cb127-348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-alt:</span></span>
<span id="cb127-349"><a href="#cb127-349" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Scatter plot showing 500 randomly sampled points in a unit square with uneven clustering."</span></span>
<span id="cb127-350"><a href="#cb127-350" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Scatter plot showing 500 Sobol sequence sampled points in a unit square with more even coverage."</span></span>
<span id="cb127-351"><a href="#cb127-351" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Scatter plot showing 500 latin hypercube sampled points in a unit square with more even coverage."</span></span>
<span id="cb127-352"><a href="#cb127-352" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb127-353"><a href="#cb127-353" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb127-354"><a href="#cb127-354" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pvrand<span class="sc">$</span>data, <span class="at">main =</span> <span class="st">"'random' design"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb127-355"><a href="#cb127-355" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pvsobol<span class="sc">$</span>data, <span class="at">main =</span> <span class="st">"'sobol' design"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb127-356"><a href="#cb127-356" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pvlhs<span class="sc">$</span>data, <span class="at">main =</span> <span class="st">"'lhs' design"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb127-357"><a href="#cb127-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-358"><a href="#cb127-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-359"><a href="#cb127-359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generalized Sampling: The `Sampler` Class</span></span>
<span id="cb127-360"><a href="#cb127-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-361"><a href="#cb127-361" aria-hidden="true" tabindex="-1"></a>It may sometimes be desirable to configure parameter sampling in more detail.</span>
<span id="cb127-362"><a href="#cb127-362" aria-hidden="true" tabindex="-1"></a><span class="in">`paradox`</span> uses the <span class="in">`r ref("Sampler")`</span> abstract base class for sampling, which has many different sub-classes that can be parameterized and combined to control the sampling process.</span>
<span id="cb127-363"><a href="#cb127-363" aria-hidden="true" tabindex="-1"></a>It is even possible to create further sub-classes of the <span class="in">`Sampler`</span> class (or of any of *its* subclasses) for even more possibilities.</span>
<span id="cb127-364"><a href="#cb127-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-365"><a href="#cb127-365" aria-hidden="true" tabindex="-1"></a>Every <span class="in">`Sampler`</span> object has a <span class="in">`r ref("sample()")`</span> function, which takes one argument, the number of instances to sample, and returns a <span class="in">`Design`</span> object.</span>
<span id="cb127-366"><a href="#cb127-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-367"><a href="#cb127-367" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1D-Samplers</span></span>
<span id="cb127-368"><a href="#cb127-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-369"><a href="#cb127-369" aria-hidden="true" tabindex="-1"></a>There is a variety of samplers that sample values for a single parameter.</span>
<span id="cb127-370"><a href="#cb127-370" aria-hidden="true" tabindex="-1"></a>These are <span class="in">`r ref("Sampler1DUnif")`</span> (uniform sampling), <span class="in">`r ref("Sampler1DCateg")`</span> (sampling for categorical parameters), <span class="in">`r ref("Sampler1DNormal")`</span> (normally distributed sampling, truncated at parameter bounds), and <span class="in">`r ref("Sampler1DRfun")`</span> (arbitrary 1D sampling, given a random-function).</span>
<span id="cb127-371"><a href="#cb127-371" aria-hidden="true" tabindex="-1"></a>These are initialized with a one-dimensional <span class="in">`r ref("ParamSet")`</span>, and can then be used to sample values.</span>
<span id="cb127-372"><a href="#cb127-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-373"><a href="#cb127-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-020}</span></span>
<span id="cb127-374"><a href="#cb127-374" aria-hidden="true" tabindex="-1"></a>sampA <span class="ot">=</span> Sampler1DCateg<span class="sc">$</span><span class="fu">new</span>(<span class="fu">ps</span>(<span class="at">x =</span> <span class="fu">p_fct</span>(letters)))</span>
<span id="cb127-375"><a href="#cb127-375" aria-hidden="true" tabindex="-1"></a>sampA<span class="sc">$</span><span class="fu">sample</span>(<span class="dv">5</span>)</span>
<span id="cb127-376"><a href="#cb127-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-377"><a href="#cb127-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-378"><a href="#cb127-378" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hierarchical Sampler</span></span>
<span id="cb127-379"><a href="#cb127-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-380"><a href="#cb127-380" aria-hidden="true" tabindex="-1"></a>The <span class="in">`r ref("SamplerHierarchical")`</span> sampler is an auxiliary sampler that combines many 1D-Samplers to get a combined distribution.</span>
<span id="cb127-381"><a href="#cb127-381" aria-hidden="true" tabindex="-1"></a>Its name "hierarchical" implies that it is able to respect parameter dependencies.</span>
<span id="cb127-382"><a href="#cb127-382" aria-hidden="true" tabindex="-1"></a>This suggests that parameters only get sampled when their dependencies are met.</span>
<span id="cb127-383"><a href="#cb127-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-384"><a href="#cb127-384" aria-hidden="true" tabindex="-1"></a>The following example shows how this works: The <span class="in">`Int`</span> parameter <span class="in">`B`</span> depends on the <span class="in">`Lgl`</span> parameter <span class="in">`A`</span> being <span class="in">`TRUE`</span>.</span>
<span id="cb127-385"><a href="#cb127-385" aria-hidden="true" tabindex="-1"></a><span class="in">`A`</span> is sampled to be <span class="in">`TRUE`</span> in about half the cases, in which case <span class="in">`B`</span> takes a value between 0 and 10.</span>
<span id="cb127-386"><a href="#cb127-386" aria-hidden="true" tabindex="-1"></a>In the cases where <span class="in">`A`</span> is <span class="in">`FALSE`</span>, <span class="in">`B`</span> is set to <span class="in">`NA`</span>.</span>
<span id="cb127-387"><a href="#cb127-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-388"><a href="#cb127-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-021}</span></span>
<span id="cb127-389"><a href="#cb127-389" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-390"><a href="#cb127-390" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> <span class="fu">p_lgl</span>(),</span>
<span id="cb127-391"><a href="#cb127-391" aria-hidden="true" tabindex="-1"></a>  <span class="at">B =</span> <span class="fu">p_int</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">depends =</span> A <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-392"><a href="#cb127-392" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-393"><a href="#cb127-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-394"><a href="#cb127-394" aria-hidden="true" tabindex="-1"></a>p_subspaces <span class="ot">=</span> p<span class="sc">$</span><span class="fu">subspaces</span>()</span>
<span id="cb127-395"><a href="#cb127-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-396"><a href="#cb127-396" aria-hidden="true" tabindex="-1"></a>sampH <span class="ot">=</span> SamplerHierarchical<span class="sc">$</span><span class="fu">new</span>(p,</span>
<span id="cb127-397"><a href="#cb127-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(Sampler1DCateg<span class="sc">$</span><span class="fu">new</span>(p_subspaces<span class="sc">$</span>A),</span>
<span id="cb127-398"><a href="#cb127-398" aria-hidden="true" tabindex="-1"></a>    Sampler1DUnif<span class="sc">$</span><span class="fu">new</span>(p_subspaces<span class="sc">$</span>B))</span>
<span id="cb127-399"><a href="#cb127-399" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-400"><a href="#cb127-400" aria-hidden="true" tabindex="-1"></a>sampled <span class="ot">=</span> sampH<span class="sc">$</span><span class="fu">sample</span>(<span class="dv">1000</span>)</span>
<span id="cb127-401"><a href="#cb127-401" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sampled<span class="sc">$</span>data)</span>
<span id="cb127-402"><a href="#cb127-402" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sampled<span class="sc">$</span>data[, <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>)], <span class="at">useNA =</span> <span class="st">"ifany"</span>)</span>
<span id="cb127-403"><a href="#cb127-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-404"><a href="#cb127-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-405"><a href="#cb127-405" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Joint Sampler</span></span>
<span id="cb127-406"><a href="#cb127-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-407"><a href="#cb127-407" aria-hidden="true" tabindex="-1"></a>Another way of combining samplers is the <span class="in">`r ref("SamplerJointIndep")`</span>.</span>
<span id="cb127-408"><a href="#cb127-408" aria-hidden="true" tabindex="-1"></a><span class="in">`SamplerJointIndep`</span> also makes it possible to combine <span class="in">`Sampler`</span>s that are not 1D.</span>
<span id="cb127-409"><a href="#cb127-409" aria-hidden="true" tabindex="-1"></a>However, <span class="in">`SamplerJointIndep`</span> currently cannot handle <span class="in">`ParamSet`</span>s with dependencies.</span>
<span id="cb127-410"><a href="#cb127-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-411"><a href="#cb127-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-022}</span></span>
<span id="cb127-412"><a href="#cb127-412" aria-hidden="true" tabindex="-1"></a>sampJ <span class="ot">=</span> SamplerJointIndep<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb127-413"><a href="#cb127-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(Sampler1DUnif<span class="sc">$</span><span class="fu">new</span>(<span class="fu">ps</span>(<span class="at">x =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>))),</span>
<span id="cb127-414"><a href="#cb127-414" aria-hidden="true" tabindex="-1"></a>    Sampler1DUnif<span class="sc">$</span><span class="fu">new</span>(<span class="fu">ps</span>(<span class="at">y =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>))))</span>
<span id="cb127-415"><a href="#cb127-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-416"><a href="#cb127-416" aria-hidden="true" tabindex="-1"></a>sampJ<span class="sc">$</span><span class="fu">sample</span>(<span class="dv">5</span>)</span>
<span id="cb127-417"><a href="#cb127-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-418"><a href="#cb127-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-419"><a href="#cb127-419" aria-hidden="true" tabindex="-1"></a><span class="fu">#### SamplerUnif</span></span>
<span id="cb127-420"><a href="#cb127-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-421"><a href="#cb127-421" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Sampler`</span> used in <span class="in">`generate_design_random()`</span> is the <span class="in">`r ref("SamplerUnif")`</span> sampler, which corresponds to a <span class="in">`HierarchicalSampler`</span> of <span class="in">`Sampler1DUnif`</span> for all parameters with dependency-aware behavior identical to <span class="in">`generate_design_random()`</span>.</span>
<span id="cb127-422"><a href="#cb127-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-423"><a href="#cb127-423" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameter Transformation</span></span>
<span id="cb127-424"><a href="#cb127-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-425"><a href="#cb127-425" aria-hidden="true" tabindex="-1"></a>While the different <span class="in">`r ref("Sampler")`</span>s allow for a wide specification of parameter distributions, there are cases where the simplest way of getting a desired distribution is to sample parameters from a simple distribution (such as the uniform distribution) and then transform them.</span>
<span id="cb127-426"><a href="#cb127-426" aria-hidden="true" tabindex="-1"></a>This can be done by constructing a <span class="in">`r ref("Domain")`</span> with a <span class="in">`trafo`</span> argument, or assigning a function to the <span class="in">`$.extra_trafo`</span> field of a <span class="in">`r ref("ParamSet")`</span>.</span>
<span id="cb127-427"><a href="#cb127-427" aria-hidden="true" tabindex="-1"></a>The latter can also be done by passing an <span class="in">`.extra_trafo`</span> argument to the <span class="in">`r ref("ps()")`</span> shorthand constructor.</span>
<span id="cb127-428"><a href="#cb127-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-429"><a href="#cb127-429" aria-hidden="true" tabindex="-1"></a>A <span class="in">`trafo`</span> function in a <span class="in">`Domain`</span> is called with a single parameter, the value to be transformed.</span>
<span id="cb127-430"><a href="#cb127-430" aria-hidden="true" tabindex="-1"></a>It can only operate on the dimension of a single parameter.</span>
<span id="cb127-431"><a href="#cb127-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-432"><a href="#cb127-432" aria-hidden="true" tabindex="-1"></a>The <span class="in">`$.extra_trafo`</span> function is called with two parameters:</span>
<span id="cb127-433"><a href="#cb127-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-434"><a href="#cb127-434" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The list of parameter values to be transformed as <span class="in">`x`</span>.</span>
<span id="cb127-435"><a href="#cb127-435" aria-hidden="true" tabindex="-1"></a>  Unlike the <span class="in">`Domain`</span>'s <span class="in">`trafo`</span>, the <span class="in">`$.extra_trafo`</span> handles the whole parameter set and can even model "interactions" between parameters.</span>
<span id="cb127-436"><a href="#cb127-436" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The <span class="in">`ParamSet`</span> itself as <span class="in">`param_set`</span></span>
<span id="cb127-437"><a href="#cb127-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-438"><a href="#cb127-438" aria-hidden="true" tabindex="-1"></a>The <span class="in">`$.extra_trafo`</span> function must return a list of transformed parameter values.</span>
<span id="cb127-439"><a href="#cb127-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-440"><a href="#cb127-440" aria-hidden="true" tabindex="-1"></a>The transformation is performed when calling the <span class="in">`$transpose()`</span> function of the <span class="in">`r ref("Design")`</span> object returned by a <span class="in">`Sampler`</span> with the <span class="in">`trafo`</span> parameter set to <span class="in">`TRUE`</span> (the default).</span>
<span id="cb127-441"><a href="#cb127-441" aria-hidden="true" tabindex="-1"></a>The following, for example, creates a parameter that is exponentially distributed:</span>
<span id="cb127-442"><a href="#cb127-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-443"><a href="#cb127-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-023}</span></span>
<span id="cb127-444"><a href="#cb127-444" aria-hidden="true" tabindex="-1"></a>psexp <span class="ot">=</span> <span class="fu">ps</span>(<span class="at">par =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">trafo =</span> <span class="cf">function</span>(x) <span class="sc">-</span><span class="fu">log</span>(x)))</span>
<span id="cb127-445"><a href="#cb127-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-446"><a href="#cb127-446" aria-hidden="true" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">generate_design_random</span>(psexp, <span class="dv">3</span>)</span>
<span id="cb127-447"><a href="#cb127-447" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(design)</span>
<span id="cb127-448"><a href="#cb127-448" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-449"><a href="#cb127-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-450"><a href="#cb127-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-451"><a href="#cb127-451" aria-hidden="true" tabindex="-1"></a>Printing the <span class="in">`Design`</span> shows the untransformed values between 0 and 1, while <span class="in">`$transpose()`</span> applies the transformation by default (<span class="in">`trafo = TRUE`</span>).</span>
<span id="cb127-452"><a href="#cb127-452" aria-hidden="true" tabindex="-1"></a>Compare this to <span class="in">`$transpose()`</span> without transformation:</span>
<span id="cb127-453"><a href="#cb127-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-454"><a href="#cb127-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-024}</span></span>
<span id="cb127-455"><a href="#cb127-455" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span><span class="fu">transpose</span>(<span class="at">trafo =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-456"><a href="#cb127-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-457"><a href="#cb127-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-458"><a href="#cb127-458" aria-hidden="true" tabindex="-1"></a>Another way to get this effect, using <span class="in">`$.extra_trafo`</span> during construction, would be:</span>
<span id="cb127-459"><a href="#cb127-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-025}</span></span>
<span id="cb127-460"><a href="#cb127-460" aria-hidden="true" tabindex="-1"></a>psexp <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-461"><a href="#cb127-461" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb127-462"><a href="#cb127-462" aria-hidden="true" tabindex="-1"></a>  <span class="at">.extra_trafo =</span> <span class="cf">function</span>(x, param_set) {</span>
<span id="cb127-463"><a href="#cb127-463" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span>par <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(x<span class="sc">$</span>par)</span>
<span id="cb127-464"><a href="#cb127-464" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb127-465"><a href="#cb127-465" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb127-466"><a href="#cb127-466" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-467"><a href="#cb127-467" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-468"><a href="#cb127-468" aria-hidden="true" tabindex="-1"></a>It is also possible to set <span class="in">`$.extra_trafo`</span> after construction of the <span class="in">`ParamSet`</span>-object.</span>
<span id="cb127-469"><a href="#cb127-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-470"><a href="#cb127-470" aria-hidden="true" tabindex="-1"></a>However, when transforming parameters independently the <span class="in">`trafo`</span> way is more recommended.</span>
<span id="cb127-471"><a href="#cb127-471" aria-hidden="true" tabindex="-1"></a><span class="in">`.extra_trafo`</span> is more useful when transforming parameters that interact in some way, or when new parameters should be generated.</span>
<span id="cb127-472"><a href="#cb127-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-473"><a href="#cb127-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-474"><a href="#cb127-474" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformation between Types</span></span>
<span id="cb127-475"><a href="#cb127-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-476"><a href="#cb127-476" aria-hidden="true" tabindex="-1"></a>Usually the design created with one <span class="in">`ParamSet`</span> is then used to configure other objects that themselves have a parameter set which defines the values they take.</span>
<span id="cb127-477"><a href="#cb127-477" aria-hidden="true" tabindex="-1"></a>The parameter sets which can be used for random sampling, however, are restricted in some ways:</span>
<span id="cb127-478"><a href="#cb127-478" aria-hidden="true" tabindex="-1"></a>They must have finite bounds, and they may not contain "untyped" (<span class="in">`r ref("p_uty")`</span>) parameters.</span>
<span id="cb127-479"><a href="#cb127-479" aria-hidden="true" tabindex="-1"></a><span class="in">`$trafo`</span> provides the glue for these situations.</span>
<span id="cb127-480"><a href="#cb127-480" aria-hidden="true" tabindex="-1"></a>There is relatively little constraint on the trafo function's return value, so it is possible to return values that have different bounds or even types than the original <span class="in">`ParamSet`</span>.</span>
<span id="cb127-481"><a href="#cb127-481" aria-hidden="true" tabindex="-1"></a>It is even possible to remove some parameters and add new ones.</span>
<span id="cb127-482"><a href="#cb127-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-483"><a href="#cb127-483" aria-hidden="true" tabindex="-1"></a>Suppose, for example, that a certain method requires a *function* as a parameter.</span>
<span id="cb127-484"><a href="#cb127-484" aria-hidden="true" tabindex="-1"></a>Let's say a function that summarizes its data in a certain way.</span>
<span id="cb127-485"><a href="#cb127-485" aria-hidden="true" tabindex="-1"></a>The user can pass functions like <span class="in">`r ref("median()")`</span> or <span class="in">`r ref("mean()")`</span>, but could also pass quantiles or something completely different.</span>
<span id="cb127-486"><a href="#cb127-486" aria-hidden="true" tabindex="-1"></a>This method would probably use the following <span class="in">`ParamSet`</span>:</span>
<span id="cb127-487"><a href="#cb127-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-488"><a href="#cb127-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-026}</span></span>
<span id="cb127-489"><a href="#cb127-489" aria-hidden="true" tabindex="-1"></a>methodPS <span class="ot">=</span> <span class="fu">ps</span>(<span class="at">fun =</span> <span class="fu">p_uty</span>(<span class="at">custom_check =</span> <span class="cf">function</span>(x) checkmate<span class="sc">::</span><span class="fu">checkFunction</span>(x, <span class="at">nargs =</span> <span class="dv">1</span>)))</span>
<span id="cb127-490"><a href="#cb127-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-491"><a href="#cb127-491" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(methodPS)</span>
<span id="cb127-492"><a href="#cb127-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-493"><a href="#cb127-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-494"><a href="#cb127-494" aria-hidden="true" tabindex="-1"></a>If one wanted to sample this method, using one of four functions, a way to do this would be:</span>
<span id="cb127-495"><a href="#cb127-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-496"><a href="#cb127-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-027}</span></span>
<span id="cb127-497"><a href="#cb127-497" aria-hidden="true" tabindex="-1"></a>samplingPS <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-498"><a href="#cb127-498" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>),</span>
<span id="cb127-499"><a href="#cb127-499" aria-hidden="true" tabindex="-1"></a>    <span class="at">trafo =</span> <span class="cf">function</span>(x) <span class="fu">get</span>(x, <span class="at">mode =</span> <span class="st">"function"</span>))</span>
<span id="cb127-500"><a href="#cb127-500" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-501"><a href="#cb127-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-502"><a href="#cb127-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-503"><a href="#cb127-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-028}</span></span>
<span id="cb127-504"><a href="#cb127-504" aria-hidden="true" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">generate_design_random</span>(samplingPS, <span class="dv">2</span>)</span>
<span id="cb127-505"><a href="#cb127-505" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(design)</span>
<span id="cb127-506"><a href="#cb127-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-507"><a href="#cb127-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-508"><a href="#cb127-508" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`Design`</span> only contains the column "<span class="in">`fun`</span>" as a <span class="in">`character`</span> column.</span>
<span id="cb127-509"><a href="#cb127-509" aria-hidden="true" tabindex="-1"></a>To get a single value as a *function*, the <span class="in">`$transpose()`</span> function is used.</span>
<span id="cb127-510"><a href="#cb127-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-511"><a href="#cb127-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-029}</span></span>
<span id="cb127-512"><a href="#cb127-512" aria-hidden="true" tabindex="-1"></a>xvals <span class="ot">=</span> design<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-513"><a href="#cb127-513" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xvals[[<span class="dv">1</span>]])</span>
<span id="cb127-514"><a href="#cb127-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-515"><a href="#cb127-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-516"><a href="#cb127-516" aria-hidden="true" tabindex="-1"></a>We can now check that it fits the requirements set by <span class="in">`methodPS`</span>, and that <span class="in">`$fun`</span> is in fact a function:</span>
<span id="cb127-517"><a href="#cb127-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-518"><a href="#cb127-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-030}</span></span>
<span id="cb127-519"><a href="#cb127-519" aria-hidden="true" tabindex="-1"></a>methodPS<span class="sc">$</span><span class="fu">check</span>(xvals[[<span class="dv">1</span>]])</span>
<span id="cb127-520"><a href="#cb127-520" aria-hidden="true" tabindex="-1"></a>xvals[[<span class="dv">1</span>]]<span class="sc">$</span><span class="fu">fun</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb127-521"><a href="#cb127-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-522"><a href="#cb127-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-523"><a href="#cb127-523" aria-hidden="true" tabindex="-1"></a><span class="in">`r ref("p_fct()")`</span> has a shortcut for this kind of transformation, where a <span class="in">`character`</span> is transformed into a specific set of (typically non-scalar) values.</span>
<span id="cb127-524"><a href="#cb127-524" aria-hidden="true" tabindex="-1"></a>When its <span class="in">`levels`</span> argument is given as a named <span class="in">`list`</span> (or named non-<span class="in">`character`</span> vector), it constructs a <span class="in">`Domain`</span> that does the trafo automatically.</span>
<span id="cb127-525"><a href="#cb127-525" aria-hidden="true" tabindex="-1"></a>A way to perform the above would therefore be:</span>
<span id="cb127-526"><a href="#cb127-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-031}</span></span>
<span id="cb127-527"><a href="#cb127-527" aria-hidden="true" tabindex="-1"></a>samplingPS <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-528"><a href="#cb127-528" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="fu">p_fct</span>(<span class="fu">list</span>(<span class="st">"mean"</span> <span class="ot">=</span> mean, <span class="st">"median"</span> <span class="ot">=</span> median, <span class="st">"min"</span> <span class="ot">=</span> min, <span class="st">"max"</span> <span class="ot">=</span> max))</span>
<span id="cb127-529"><a href="#cb127-529" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-530"><a href="#cb127-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-531"><a href="#cb127-531" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_design_random</span>(samplingPS, <span class="dv">1</span>)<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-532"><a href="#cb127-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-533"><a href="#cb127-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-534"><a href="#cb127-534" aria-hidden="true" tabindex="-1"></a>Imagine now that a different kind of parametrization of the function is desired:</span>
<span id="cb127-535"><a href="#cb127-535" aria-hidden="true" tabindex="-1"></a>The user wants to give a function that selects a certain quantile, where the quantile is set by a parameter.</span>
<span id="cb127-536"><a href="#cb127-536" aria-hidden="true" tabindex="-1"></a>In that case the <span class="in">`$transpose()`</span> function could generate a function in a different way.</span>
<span id="cb127-537"><a href="#cb127-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-538"><a href="#cb127-538" aria-hidden="true" tabindex="-1"></a>For interpretability, the parameter should be called "<span class="in">`quantile`</span>" before transformation, and the "<span class="in">`fun`</span>" parameter is generated on the fly.</span>
<span id="cb127-539"><a href="#cb127-539" aria-hidden="true" tabindex="-1"></a>We therefore use an <span class="in">`.extra_trafo`</span> here, given as a function to the <span class="in">`ps()`</span> call.</span>
<span id="cb127-540"><a href="#cb127-540" aria-hidden="true" tabindex="-1"></a>The <span class="in">`.extra_trafo`</span> receives the sampled <span class="in">`quantile`</span> value (a <span class="in">`numeric(1)`</span> between 0 and 1) and turns it into a function that computes the corresponding quantile of its input.</span>
<span id="cb127-541"><a href="#cb127-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-542"><a href="#cb127-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-032}</span></span>
<span id="cb127-543"><a href="#cb127-543" aria-hidden="true" tabindex="-1"></a>samplingPS2 <span class="ot">=</span> <span class="fu">ps</span>(<span class="at">quantile =</span> <span class="fu">p_dbl</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb127-544"><a href="#cb127-544" aria-hidden="true" tabindex="-1"></a>  <span class="at">.extra_trafo =</span> <span class="cf">function</span>(x, param_set) {</span>
<span id="cb127-545"><a href="#cb127-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">fun =</span> <span class="cf">function</span>(input) <span class="fu">quantile</span>(input, x<span class="sc">$</span>quantile))</span>
<span id="cb127-546"><a href="#cb127-546" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb127-547"><a href="#cb127-547" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-548"><a href="#cb127-548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-549"><a href="#cb127-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-550"><a href="#cb127-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-033}</span></span>
<span id="cb127-551"><a href="#cb127-551" aria-hidden="true" tabindex="-1"></a>design <span class="ot">=</span> <span class="fu">generate_design_random</span>(samplingPS2, <span class="dv">2</span>)</span>
<span id="cb127-552"><a href="#cb127-552" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(design)</span>
<span id="cb127-553"><a href="#cb127-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-554"><a href="#cb127-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-555"><a href="#cb127-555" aria-hidden="true" tabindex="-1"></a>The <span class="in">`Design`</span> now contains the column "<span class="in">`quantile`</span>" that will be used by the <span class="in">`$transpose()`</span> function to create the <span class="in">`fun`</span> parameter.</span>
<span id="cb127-556"><a href="#cb127-556" aria-hidden="true" tabindex="-1"></a>We also check that it fits the requirement set by <span class="in">`methodPS`</span>, and that it is a function.</span>
<span id="cb127-557"><a href="#cb127-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-558"><a href="#cb127-558" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-034}</span></span>
<span id="cb127-559"><a href="#cb127-559" aria-hidden="true" tabindex="-1"></a>xvals <span class="ot">=</span> design<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-560"><a href="#cb127-560" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(xvals[[<span class="dv">1</span>]])</span>
<span id="cb127-561"><a href="#cb127-561" aria-hidden="true" tabindex="-1"></a>methodPS<span class="sc">$</span><span class="fu">check</span>(xvals[[<span class="dv">1</span>]])</span>
<span id="cb127-562"><a href="#cb127-562" aria-hidden="true" tabindex="-1"></a>xvals[[<span class="dv">1</span>]]<span class="sc">$</span><span class="fu">fun</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb127-563"><a href="#cb127-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-564"><a href="#cb127-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-565"><a href="#cb127-565" aria-hidden="true" tabindex="-1"></a><span class="fu">### Automatic Factor Level Transformation</span></span>
<span id="cb127-566"><a href="#cb127-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-567"><a href="#cb127-567" aria-hidden="true" tabindex="-1"></a>A common use-case is the necessity to specify a list of values that should all be tried (or sampled from).</span>
<span id="cb127-568"><a href="#cb127-568" aria-hidden="true" tabindex="-1"></a>It may be the case that a hyperparameter accepts function objects as values and a certain list of functions should be tried.</span>
<span id="cb127-569"><a href="#cb127-569" aria-hidden="true" tabindex="-1"></a>Or it may be that a choice of special numeric values should be tried.</span>
<span id="cb127-570"><a href="#cb127-570" aria-hidden="true" tabindex="-1"></a>For this, the <span class="in">`p_fct()`</span> constructor's <span class="in">`level`</span> argument may be a value that is not a <span class="in">`character`</span> vector, but something else.</span>
<span id="cb127-571"><a href="#cb127-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-572"><a href="#cb127-572" aria-hidden="true" tabindex="-1"></a>Suppose we define a search space with <span class="in">`ps()`</span> as described in @sec-tune-ps.</span>
<span id="cb127-573"><a href="#cb127-573" aria-hidden="true" tabindex="-1"></a>If, for example, only the values <span class="in">`0.1`</span>, <span class="in">`3`</span>, and <span class="in">`10`</span> should be tried for the <span class="in">`cost`</span> parameter, even when doing random search, we can construct the search space as follows:</span>
<span id="cb127-574"><a href="#cb127-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-575"><a href="#cb127-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-035}</span></span>
<span id="cb127-576"><a href="#cb127-576" aria-hidden="true" tabindex="-1"></a>search_space <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-577"><a href="#cb127-577" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">3</span>, <span class="dv">10</span>)),</span>
<span id="cb127-578"><a href="#cb127-578" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="st">"polynomial"</span>, <span class="st">"radial"</span>))</span>
<span id="cb127-579"><a href="#cb127-579" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-580"><a href="#cb127-580" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(search_space, <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>())</span>
<span id="cb127-581"><a href="#cb127-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-582"><a href="#cb127-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-583"><a href="#cb127-583" aria-hidden="true" tabindex="-1"></a>This is equivalent to the following:</span>
<span id="cb127-584"><a href="#cb127-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-036}</span></span>
<span id="cb127-585"><a href="#cb127-585" aria-hidden="true" tabindex="-1"></a>search_space <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-586"><a href="#cb127-586" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="st">"0.1"</span>, <span class="st">"3"</span>, <span class="st">"10"</span>),</span>
<span id="cb127-587"><a href="#cb127-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">trafo =</span> <span class="cf">function</span>(x) <span class="fu">list</span>(<span class="st">`</span><span class="at">0.1</span><span class="st">`</span> <span class="ot">=</span> <span class="fl">0.1</span>, <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">`</span><span class="at">10</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">10</span>)[[x]]),</span>
<span id="cb127-588"><a href="#cb127-588" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="st">"polynomial"</span>, <span class="st">"radial"</span>))</span>
<span id="cb127-589"><a href="#cb127-589" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-590"><a href="#cb127-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-591"><a href="#cb127-591" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(search_space, <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>())</span>
<span id="cb127-592"><a href="#cb127-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-593"><a href="#cb127-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-594"><a href="#cb127-594" aria-hidden="true" tabindex="-1"></a>Note: Though the resolution is 3 here, in this case it doesn't matter because both <span class="in">`cost`</span> and <span class="in">`kernel`</span> are factors (the resolution for categorical variables is ignored, these parameters always produce a grid over all their valid levels).</span>
<span id="cb127-595"><a href="#cb127-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-596"><a href="#cb127-596" aria-hidden="true" tabindex="-1"></a>This may seem silly, but makes sense when considering that factorial tuning parameters are always <span class="in">`character`</span> values:</span>
<span id="cb127-597"><a href="#cb127-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-598"><a href="#cb127-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-037}</span></span>
<span id="cb127-599"><a href="#cb127-599" aria-hidden="true" tabindex="-1"></a>search_space <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-600"><a href="#cb127-600" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">3</span>, <span class="dv">10</span>)),</span>
<span id="cb127-601"><a href="#cb127-601" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="fu">p_fct</span>(<span class="fu">c</span>(<span class="st">"polynomial"</span>, <span class="st">"radial"</span>))</span>
<span id="cb127-602"><a href="#cb127-602" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-603"><a href="#cb127-603" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(search_space<span class="sc">$</span>params<span class="sc">$</span>cost<span class="sc">$</span>levels)</span>
<span id="cb127-604"><a href="#cb127-604" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-605"><a href="#cb127-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-606"><a href="#cb127-606" aria-hidden="true" tabindex="-1"></a>Be aware that this results in an "unordered" hyperparameter, however.</span>
<span id="cb127-607"><a href="#cb127-607" aria-hidden="true" tabindex="-1"></a>Tuning algorithms that make use of ordering information of parameters, like genetic algorithms or model based optimization, will perform worse when this is done.</span>
<span id="cb127-608"><a href="#cb127-608" aria-hidden="true" tabindex="-1"></a>For these algorithms, it may make more sense to define a <span class="in">`r ref("p_dbl()")`</span> or <span class="in">`r ref("p_int()")`</span> with a more fitting trafo.</span>
<span id="cb127-609"><a href="#cb127-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-610"><a href="#cb127-610" aria-hidden="true" tabindex="-1"></a>An example is the <span class="in">`class.weights`</span> parameter of the Support Vector Machine (SVM), which takes a named vector of class weights with one entry per target class.</span>
<span id="cb127-611"><a href="#cb127-611" aria-hidden="true" tabindex="-1"></a>If only a few candidate vectors are to be tried, <span class="in">`class.weights`</span> can be implemented as follows.</span>
<span id="cb127-612"><a href="#cb127-612" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`levels`</span> argument of <span class="in">`p_fct()`</span> must be named if there is no easy way for <span class="in">`r ref("as.character()")`</span> to create names:</span>
<span id="cb127-613"><a href="#cb127-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-614"><a href="#cb127-614" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-038}</span></span>
<span id="cb127-615"><a href="#cb127-615" aria-hidden="true" tabindex="-1"></a>search_space <span class="ot">=</span> <span class="fu">ps</span>(</span>
<span id="cb127-616"><a href="#cb127-616" aria-hidden="true" tabindex="-1"></a>  <span class="at">class.weights =</span> <span class="fu">p_fct</span>(</span>
<span id="cb127-617"><a href="#cb127-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(</span>
<span id="cb127-618"><a href="#cb127-618" aria-hidden="true" tabindex="-1"></a>      <span class="at">candidate_a =</span> <span class="fu">c</span>(<span class="at">spam =</span> <span class="fl">0.5</span>, <span class="at">nonspam =</span> <span class="fl">0.5</span>),</span>
<span id="cb127-619"><a href="#cb127-619" aria-hidden="true" tabindex="-1"></a>      <span class="at">candidate_b =</span> <span class="fu">c</span>(<span class="at">spam =</span> <span class="fl">0.3</span>, <span class="at">nonspam =</span> <span class="fl">0.7</span>)</span>
<span id="cb127-620"><a href="#cb127-620" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb127-621"><a href="#cb127-621" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb127-622"><a href="#cb127-622" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-623"><a href="#cb127-623" aria-hidden="true" tabindex="-1"></a><span class="fu">generate_design_grid</span>(search_space)<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-624"><a href="#cb127-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-625"><a href="#cb127-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-626"><a href="#cb127-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Defining a Tuning Space {#sec-paradox-tuning-spaces}</span></span>
<span id="cb127-627"><a href="#cb127-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-628"><a href="#cb127-628" aria-hidden="true" tabindex="-1"></a>When running an optimization, it is important to inform the tuning algorithm about what hyperparameters are valid.</span>
<span id="cb127-629"><a href="#cb127-629" aria-hidden="true" tabindex="-1"></a>Here the names, types, and valid ranges of each hyperparameter are important.</span>
<span id="cb127-630"><a href="#cb127-630" aria-hidden="true" tabindex="-1"></a>All this information is communicated with objects of the class <span class="in">`r ref("ParamSet")`</span>, which is defined in <span class="in">`r paradox`</span>.</span>
<span id="cb127-631"><a href="#cb127-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-632"><a href="#cb127-632" aria-hidden="true" tabindex="-1"></a>Note, that <span class="in">`ParamSet`</span> objects exist in two contexts.</span>
<span id="cb127-633"><a href="#cb127-633" aria-hidden="true" tabindex="-1"></a>First, parameter set-objects are used to define the space of valid parameter settings for a learner (and other objects).</span>
<span id="cb127-634"><a href="#cb127-634" aria-hidden="true" tabindex="-1"></a>Second, they are used to define a search space for tuning.</span>
<span id="cb127-635"><a href="#cb127-635" aria-hidden="true" tabindex="-1"></a>We are mainly interested in the latter.</span>
<span id="cb127-636"><a href="#cb127-636" aria-hidden="true" tabindex="-1"></a>For example we can consider the <span class="in">`minsplit`</span> parameter of the <span class="in">`lrn("classif.rpart")`</span>.</span>
<span id="cb127-637"><a href="#cb127-637" aria-hidden="true" tabindex="-1"></a>The <span class="in">`ParamSet`</span> associated with the learner has a lower but *no* upper bound.</span>
<span id="cb127-638"><a href="#cb127-638" aria-hidden="true" tabindex="-1"></a>However, for tuning the value, a lower *and* upper bound must be given because tuning search spaces need to be bounded.</span>
<span id="cb127-639"><a href="#cb127-639" aria-hidden="true" tabindex="-1"></a>For <span class="in">`r ref("Learner")`</span> or <span class="in">`r ref("PipeOp")`</span> objects, typically "unbounded" parameter sets are used.</span>
<span id="cb127-640"><a href="#cb127-640" aria-hidden="true" tabindex="-1"></a>Here, however, we will mainly focus on creating "bounded" parameter sets that can be used for tuning.</span>
<span id="cb127-641"><a href="#cb127-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-642"><a href="#cb127-642" aria-hidden="true" tabindex="-1"></a>How search spaces can be created using <span class="in">`r ref("ps()")`</span> has been outlined in @sec-tune-ps.</span>
<span id="cb127-643"><a href="#cb127-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-644"><a href="#cb127-644" aria-hidden="true" tabindex="-1"></a><span class="fu">### Creating Tuning ParamSets from other ParamSets {#sec-paradox-creation-tuning-paramset-from-learner}</span></span>
<span id="cb127-645"><a href="#cb127-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-646"><a href="#cb127-646" aria-hidden="true" tabindex="-1"></a>Having to define a tuning <span class="in">`ParamSet`</span> for a <span class="in">`Learner`</span> that already has parameter set information may seem unnecessarily tedious, and there is indeed a way to create tuning <span class="in">`ParamSet`</span>s from a <span class="in">`Learner`</span>'s parameter set, making use of as much information as already available.</span>
<span id="cb127-647"><a href="#cb127-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-648"><a href="#cb127-648" aria-hidden="true" tabindex="-1"></a>This is done by setting values of a <span class="in">`Learner`</span>'s <span class="in">`ParamSet`</span> to so-called <span class="in">`r ref("TuneToken")`</span>s, constructed with a <span class="in">`r ref("to_tune()")`</span> call.</span>
<span id="cb127-649"><a href="#cb127-649" aria-hidden="true" tabindex="-1"></a>This can be done in the same way that other hyperparameters are set to specific values.</span>
<span id="cb127-650"><a href="#cb127-650" aria-hidden="true" tabindex="-1"></a>It can be understood as the hyperparameters being tagged for later tuning.</span>
<span id="cb127-651"><a href="#cb127-651" aria-hidden="true" tabindex="-1"></a>The resulting <span class="in">`ParamSet`</span> used for tuning can be retrieved using the <span class="in">`$search_space()`</span> method.</span>
<span id="cb127-652"><a href="#cb127-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-653"><a href="#cb127-653" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-039}</span></span>
<span id="cb127-654"><a href="#cb127-654" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"mlr3learners"</span>)</span>
<span id="cb127-655"><a href="#cb127-655" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>)</span>
<span id="cb127-656"><a href="#cb127-656" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>kernel <span class="ot">=</span> <span class="st">"polynomial"</span> <span class="co"># for example</span></span>
<span id="cb127-657"><a href="#cb127-657" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>degree <span class="ot">=</span> <span class="fu">to_tune</span>(<span class="at">lower =</span> <span class="dv">1</span>, <span class="at">upper =</span> <span class="dv">3</span>)</span>
<span id="cb127-658"><a href="#cb127-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-659"><a href="#cb127-659" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>())</span>
<span id="cb127-660"><a href="#cb127-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-661"><a href="#cb127-661" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(</span>
<span id="cb127-662"><a href="#cb127-662" aria-hidden="true" tabindex="-1"></a>  learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>(), <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-663"><a href="#cb127-663" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-664"><a href="#cb127-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-665"><a href="#cb127-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-666"><a href="#cb127-666" aria-hidden="true" tabindex="-1"></a>It is possible to omit <span class="in">`lower`</span> here, because it can be inferred from the lower bound of the <span class="in">`degree`</span> parameter itself.</span>
<span id="cb127-667"><a href="#cb127-667" aria-hidden="true" tabindex="-1"></a>For other parameters, that are already bounded, it is possible to not give any bounds at all, because their ranges are already bounded.</span>
<span id="cb127-668"><a href="#cb127-668" aria-hidden="true" tabindex="-1"></a>An example is the logical <span class="in">`$shrinking`</span> hyperparameter:</span>
<span id="cb127-669"><a href="#cb127-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-670"><a href="#cb127-670" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-040}</span></span>
<span id="cb127-671"><a href="#cb127-671" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>shrinking <span class="ot">=</span> <span class="fu">to_tune</span>()</span>
<span id="cb127-672"><a href="#cb127-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-673"><a href="#cb127-673" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>())</span>
<span id="cb127-674"><a href="#cb127-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-675"><a href="#cb127-675" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(</span>
<span id="cb127-676"><a href="#cb127-676" aria-hidden="true" tabindex="-1"></a>  learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>(), <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>()</span>
<span id="cb127-677"><a href="#cb127-677" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-678"><a href="#cb127-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-679"><a href="#cb127-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-680"><a href="#cb127-680" aria-hidden="true" tabindex="-1"></a><span class="in">`to_tune()`</span> can also be constructed with a <span class="in">`Domain`</span> object, i.e. something constructed with a <span class="in">`p_***`</span> call.</span>
<span id="cb127-681"><a href="#cb127-681" aria-hidden="true" tabindex="-1"></a>This way it is possible to tune continuous parameters with discrete values, or to give trafos or dependencies.</span>
<span id="cb127-682"><a href="#cb127-682" aria-hidden="true" tabindex="-1"></a>One could, for example, tune the <span class="in">`$cost`</span> as above on three given special values, and introduce a dependency of <span class="in">`$shrinking`</span> on it.</span>
<span id="cb127-683"><a href="#cb127-683" aria-hidden="true" tabindex="-1"></a>Notice that <span class="in">`to_tune(&lt;levels&gt;)`</span> is a short form of <span class="in">`to_tune(p_fct(&lt;levels&gt;))`</span>.</span>
<span id="cb127-684"><a href="#cb127-684" aria-hidden="true" tabindex="-1"></a>When introducing the dependency, we need to use the <span class="in">`cost`</span> value from *before* the implicit trafo, which is the name or <span class="in">`r ref("as.character()")`</span> of the respective value, here <span class="in">`"val2"`</span>!</span>
<span id="cb127-685"><a href="#cb127-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-686"><a href="#cb127-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-041}</span></span>
<span id="cb127-687"><a href="#cb127-687" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>cost <span class="ot">=</span> <span class="fu">to_tune</span>(<span class="fu">c</span>(<span class="at">val1 =</span> <span class="fl">0.3</span>, <span class="at">val2 =</span> <span class="fl">0.7</span>))</span>
<span id="cb127-688"><a href="#cb127-688" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>shrinking <span class="ot">=</span> <span class="fu">to_tune</span>(<span class="fu">p_lgl</span>(<span class="at">depends =</span> cost <span class="sc">==</span> <span class="st">"val2"</span>))</span>
<span id="cb127-689"><a href="#cb127-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-690"><a href="#cb127-690" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>())</span>
<span id="cb127-691"><a href="#cb127-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-692"><a href="#cb127-692" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>(), <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>(), <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-693"><a href="#cb127-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-694"><a href="#cb127-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-695"><a href="#cb127-695" aria-hidden="true" tabindex="-1"></a>The <span class="in">`$search_space()`</span> picks up dependencies from the underlying <span class="in">`ParamSet`</span> automatically.</span>
<span id="cb127-696"><a href="#cb127-696" aria-hidden="true" tabindex="-1"></a>So if the <span class="in">`kernel`</span> is tuned, then <span class="in">`degree`</span> automatically gets the dependency on it, without us having to specify that.</span>
<span id="cb127-697"><a href="#cb127-697" aria-hidden="true" tabindex="-1"></a>(Here we reset <span class="in">`$cost`</span> and <span class="in">`$shrinking`</span> to <span class="in">`NULL`</span> for the sake of clarity of the generated output.)</span>
<span id="cb127-698"><a href="#cb127-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-699"><a href="#cb127-699" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-042}</span></span>
<span id="cb127-700"><a href="#cb127-700" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>cost <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb127-701"><a href="#cb127-701" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>shrinking <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb127-702"><a href="#cb127-702" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>kernel <span class="ot">=</span> <span class="fu">to_tune</span>(<span class="fu">c</span>(<span class="st">"polynomial"</span>, <span class="st">"radial"</span>))</span>
<span id="cb127-703"><a href="#cb127-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-704"><a href="#cb127-704" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>())</span>
<span id="cb127-705"><a href="#cb127-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-706"><a href="#cb127-706" aria-hidden="true" tabindex="-1"></a><span class="fu">rbindlist</span>(<span class="fu">generate_design_grid</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>(), <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>(), <span class="at">fill =</span> <span class="cn">TRUE</span>)</span>
<span id="cb127-707"><a href="#cb127-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-708"><a href="#cb127-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-709"><a href="#cb127-709" aria-hidden="true" tabindex="-1"></a>It is even possible to define whole <span class="in">`ParamSet`</span>s that get tuned over for a single parameter.</span>
<span id="cb127-710"><a href="#cb127-710" aria-hidden="true" tabindex="-1"></a>This may be especially useful for vector hyperparameters that should be searched along multiple dimensions.</span>
<span id="cb127-711"><a href="#cb127-711" aria-hidden="true" tabindex="-1"></a>This parameter set must, however, have an <span class="in">`.extra_trafo`</span> that returns a list with a single element, because it corresponds to a single hyperparameter that is being tuned.</span>
<span id="cb127-712"><a href="#cb127-712" aria-hidden="true" tabindex="-1"></a>Suppose the <span class="in">`$class.weights`</span> hyperparameter should be tuned along two dimensions:</span>
<span id="cb127-713"><a href="#cb127-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-714"><a href="#cb127-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r advanced_hyperparameter_specification_using_paradox-043}</span></span>
<span id="cb127-715"><a href="#cb127-715" aria-hidden="true" tabindex="-1"></a>learner<span class="sc">$</span>param_set<span class="sc">$</span>values<span class="sc">$</span>class.weights <span class="ot">=</span> <span class="fu">to_tune</span>(</span>
<span id="cb127-716"><a href="#cb127-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ps</span>(<span class="at">spam =</span> <span class="fu">p_dbl</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="at">nonspam =</span> <span class="fu">p_dbl</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</span>
<span id="cb127-717"><a href="#cb127-717" aria-hidden="true" tabindex="-1"></a>    <span class="at">.extra_trafo =</span> <span class="cf">function</span>(x, param_set) <span class="fu">list</span>(<span class="fu">c</span>(<span class="at">spam =</span> x<span class="sc">$</span>spam, <span class="at">nonspam =</span> x<span class="sc">$</span>nonspam))</span>
<span id="cb127-718"><a href="#cb127-718" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb127-719"><a href="#cb127-719" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">generate_design_grid</span>(learner<span class="sc">$</span>param_set<span class="sc">$</span><span class="fu">search_space</span>(), <span class="dv">3</span>)<span class="sc">$</span><span class="fu">transpose</span>(), <span class="dv">3</span>)</span>
<span id="cb127-720"><a href="#cb127-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb127-721"><a href="#cb127-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-722"><a href="#cb127-722" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb127-723"><a href="#cb127-723" aria-hidden="true" tabindex="-1"></a><span class="in">`r citeas(chapter)`</span></span>
<span id="cb127-724"><a href="#cb127-724" aria-hidden="true" tabindex="-1"></a>:::</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>All content licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> <br> © Bernd Bischl, Raphael Sonabend, Lars Kotthoff, Michel Lang.</p>
</div>   
    <div class="nav-footer-center">
<p><a href="https://mlr-org.com">Website</a> | <a href="https://github.com/mlr-org/mlr3book">GitHub</a> | <a href="https://mlr-org.com/gallery">Gallery</a> | <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">Mattermost</a></p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mlr-org/mlr3book/edit/main/book/chapters/chapter16/advanced_hyperparameter_specification_using_paradox.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/mlr-org/mlr3book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/mlr-org/mlr3book/blob/main/book/chapters/chapter16/advanced_hyperparameter_specification_using_paradox.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>