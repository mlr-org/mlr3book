# The Building Blocks: PipeOps {#pipe-pipeops}

```{r 05-pipelines-pipeops-001, include = F}
library(mlr3)
library(mlr3book)
library(mlr3pipelines)
```

The building blocks of `r mlr3book::mlr_pkg("mlr3pipelines")` are **PipeOp**-objects (PO).
They can be constructed directly using `PipeOp<NAME>$new()`, but the recommended way is to retrieve them from the `r ref("mlr_pipeops")` dictionary:

```{r 05-pipelines-pipeops-002}
library("mlr3pipelines")
as.data.table(mlr_pipeops)
```

Single POs can be created using the dictionary:

```{r 05-pipelines-pipeops-003}
pca = mlr_pipeops$get("pca")
```

or using **syntactic sugar** `po(<name>)`:

```{r 05-pipelines-pipeops-004, eval = FALSE}
pca = po("pca")
```

Some POs require additional arguments for construction:

```{r 05-pipelines-pipeops-005, eval = FALSE}
learner = po("learner")

# Error in as_learner(learner) : argument "learner" is missing, with no default argument "learner" is missing, with no default
```

```{r 05-pipelines-pipeops-006}
learner = mlr_pipeops$get("learner", lrn("classif.rpart"))
```

or in short `po("learner", lrn("classif.rpart"))`.

Hyperparameters of POs can be set through the `param_vals` argument.
Here we set the fraction of features for a filter:

```{r 05-pipelines-pipeops-007}
filter = po("filter",
  filter = mlr3filters::flt("variance"),
  param_vals = list(filter.frac = 0.5))
```

or in short notation:

```{r 05-pipelines-pipeops-008, eval = FALSE}
po("filter", mlr3filters::flt("variance"), filter.frac = 0.5)
```

The figure below shows an exemplary `r ref("PipeOp")`.
It takes an input, transforms it during `.$train` and `.$predict` and returns data:

```{r 05-pipelines-pipeops-009, echo=FALSE}
knitr::include_graphics("images/po_viz.png")
```
