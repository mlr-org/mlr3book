## Survival Analysis {#survival}

The package `r mlr_pkg("mlr3survival")` extends `r mlr_pkg("mlr3")` with the following objects for survival analysis:

* `r ref("mlr3survival::TaskSurv", text = "TaskSurv")` to define (right-censored) survival tasks
* `r ref("mlr3survival::LearnerSurv", text = "LearnerSurv")` as base class for survival learners
* `r ref("mlr3survival::PredictionSurv", text = "PredictionSurv")` as specialized class for `r ref("Prediction")` objects
* `r ref("mlr3survival::MeasureSurv", text = "MeasureSurv")` as specialized class for performance measures

In this example we demonstrate the basic functionality of the package on the `r ref("survival::rats", text = "rats")` data from the `r cran_pkg("survival")` package.
This task ships as pre-defined `r ref("TaskSurv")` with `r mlr_pkg("mlr3survival")`.

```{r 06-survival-001}
library(mlr3survival)
task = mlr_tasks$get("rats")
print(task)
mlr3viz::autoplot(task)

# the target column is a survival object:
head(task$truth())

# kaplan meier estimator of survival times
task$survfit()

# kaplan-meier estimator of survival times
# stratify on binarized age variable
sf = task$survfit("sex")
print(sf)

# plot survfit object with ggfortify
library("ggfortify")
autoplot(sf)
```

Now, we conduct a small benchmark study on the `r ref("mlr_tasks_rats", text = "rats")` task using some of the integrated survival learners:
```{r 06-survival-002}
# integrated learners
learners = mlr_learners$mget(c("surv.coxph", "surv.rpart", "surv.ranger"))
print(learners)

measures = mlr_measures$keys("^surv")
print(measures)

set.seed(1)
bmr = benchmark(benchmark_grid(task, learners, "cv"))
print(bmr)

mlr3viz::autoplot(bmr, measure = measures[1])
mlr3viz::autoplot(bmr, measure = measures[2])
```
